parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"EK2n":[function(require,module,exports) {
var global = arguments[3];
var e,t,n=arguments[3],a=n.MutationObserver||n.WebKitMutationObserver;if(a){var o=0,r=new a(u),s=n.document.createTextNode("");r.observe(s,{characterData:!0}),e=function(){s.data=o=++o%2}}else if(n.setImmediate||void 0===n.MessageChannel)e="document"in n&&"onreadystatechange"in n.document.createElement("script")?function(){var e=n.document.createElement("script");e.onreadystatechange=function(){u(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},n.document.documentElement.appendChild(e)}:function(){setTimeout(u,0)};else{var c=new n.MessageChannel;c.port1.onmessage=u,e=function(){c.port2.postMessage(0)}}var i=[];function u(){var e,n;t=!0;for(var a=i.length;a;){for(n=i,i=[],e=-1;++e<a;)n[e]();a=i.length}t=!1}function d(n){1!==i.push(n)||t||e()}module.exports=d;
},{}],"ogM3":[function(require,module,exports) {
var r="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(r){var e=new Uint8Array(16);module.exports=function(){return r(e),e}}else{var n=new Array(16);module.exports=function(){for(var r,e=0;e<16;e++)0==(3&e)&&(r=4294967296*Math.random()),n[e]=r>>>((3&e)<<3)&255;return n}}
},{}],"O4sp":[function(require,module,exports) {
for(var r=[],t=0;t<256;++t)r[t]=(t+256).toString(16).substr(1);function o(t,o){var n=o||0,u=r;return u[t[n++]]+u[t[n++]]+u[t[n++]]+u[t[n++]]+"-"+u[t[n++]]+u[t[n++]]+"-"+u[t[n++]]+u[t[n++]]+"-"+u[t[n++]]+u[t[n++]]+"-"+u[t[n++]]+u[t[n++]]+u[t[n++]]+u[t[n++]]+u[t[n++]]+u[t[n++]]}module.exports=o;
},{}],"acME":[function(require,module,exports) {
var e,r,o=require("./lib/rng"),s=require("./lib/bytesToUuid"),i=0,n=0;function c(c,l,u){var v=l&&u||0,a=l||[],d=(c=c||{}).node||e,t=void 0!==c.clockseq?c.clockseq:r;if(null==d||null==t){var m=o();null==d&&(d=e=[1|m[0],m[1],m[2],m[3],m[4],m[5]]),null==t&&(t=r=16383&(m[6]<<8|m[7]))}var q=void 0!==c.msecs?c.msecs:(new Date).getTime(),f=void 0!==c.nsecs?c.nsecs:n+1,b=q-i+(f-n)/1e4;if(b<0&&void 0===c.clockseq&&(t=t+1&16383),(b<0||q>i)&&void 0===c.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");i=q,n=f,r=t;var k=(1e4*(268435455&(q+=122192928e5))+f)%4294967296;a[v++]=k>>>24&255,a[v++]=k>>>16&255,a[v++]=k>>>8&255,a[v++]=255&k;var w=q/4294967296*1e4&268435455;a[v++]=w>>>8&255,a[v++]=255&w,a[v++]=w>>>24&15|16,a[v++]=w>>>16&255,a[v++]=t>>>8|128,a[v++]=255&t;for(var g=0;g<6;++g)a[v+g]=d[g];return l||s(a)}module.exports=c;
},{"./lib/rng":"ogM3","./lib/bytesToUuid":"O4sp"}],"37UO":[function(require,module,exports) {
var r=require("./lib/rng"),n=require("./lib/bytesToUuid");function e(e,i,u){var a=i&&u||0;"string"==typeof e&&(i="binary"===e?new Array(16):null,e=null);var l=(e=e||{}).random||(e.rng||r)();if(l[6]=15&l[6]|64,l[8]=63&l[8]|128,i)for(var o=0;o<16;++o)i[a+o]=l[o];return i||n(l)}module.exports=e;
},{"./lib/rng":"ogM3","./lib/bytesToUuid":"O4sp"}],"gV9a":[function(require,module,exports) {
var e=require("./v1"),r=require("./v4"),v=r;v.v1=e,v.v4=r,module.exports=v;
},{"./v1":"acME","./v4":"37UO"}],"AoQO":[function(require,module,exports) {
var define;
var t;!function(r){if("object"==typeof exports)module.exports=r();else if("function"==typeof t&&t.amd)t(r);else{var e;try{e=window}catch(n){e=self}e.SparkMD5=r()}}(function(t){"use strict";var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function e(t,r){var e=t[0],n=t[1],f=t[2],i=t[3];n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&f|~n&i)+r[0]-680876936|0)<<7|e>>>25)+n|0)&n|~e&f)+r[1]-389564586|0)<<12|i>>>20)+e|0)&e|~i&n)+r[2]+606105819|0)<<17|f>>>15)+i|0)&i|~f&e)+r[3]-1044525330|0)<<22|n>>>10)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&f|~n&i)+r[4]-176418897|0)<<7|e>>>25)+n|0)&n|~e&f)+r[5]+1200080426|0)<<12|i>>>20)+e|0)&e|~i&n)+r[6]-1473231341|0)<<17|f>>>15)+i|0)&i|~f&e)+r[7]-45705983|0)<<22|n>>>10)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&f|~n&i)+r[8]+1770035416|0)<<7|e>>>25)+n|0)&n|~e&f)+r[9]-1958414417|0)<<12|i>>>20)+e|0)&e|~i&n)+r[10]-42063|0)<<17|f>>>15)+i|0)&i|~f&e)+r[11]-1990404162|0)<<22|n>>>10)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&f|~n&i)+r[12]+1804603682|0)<<7|e>>>25)+n|0)&n|~e&f)+r[13]-40341101|0)<<12|i>>>20)+e|0)&e|~i&n)+r[14]-1502002290|0)<<17|f>>>15)+i|0)&i|~f&e)+r[15]+1236535329|0)<<22|n>>>10)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&i|f&~i)+r[1]-165796510|0)<<5|e>>>27)+n|0)&f|n&~f)+r[6]-1069501632|0)<<9|i>>>23)+e|0)&n|e&~n)+r[11]+643717713|0)<<14|f>>>18)+i|0)&e|i&~e)+r[0]-373897302|0)<<20|n>>>12)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&i|f&~i)+r[5]-701558691|0)<<5|e>>>27)+n|0)&f|n&~f)+r[10]+38016083|0)<<9|i>>>23)+e|0)&n|e&~n)+r[15]-660478335|0)<<14|f>>>18)+i|0)&e|i&~e)+r[4]-405537848|0)<<20|n>>>12)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&i|f&~i)+r[9]+568446438|0)<<5|e>>>27)+n|0)&f|n&~f)+r[14]-1019803690|0)<<9|i>>>23)+e|0)&n|e&~n)+r[3]-187363961|0)<<14|f>>>18)+i|0)&e|i&~e)+r[8]+1163531501|0)<<20|n>>>12)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&i|f&~i)+r[13]-1444681467|0)<<5|e>>>27)+n|0)&f|n&~f)+r[2]-51403784|0)<<9|i>>>23)+e|0)&n|e&~n)+r[7]+1735328473|0)<<14|f>>>18)+i|0)&e|i&~e)+r[12]-1926607734|0)<<20|n>>>12)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n^f^i)+r[5]-378558|0)<<4|e>>>28)+n|0)^n^f)+r[8]-2022574463|0)<<11|i>>>21)+e|0)^e^n)+r[11]+1839030562|0)<<16|f>>>16)+i|0)^i^e)+r[14]-35309556|0)<<23|n>>>9)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n^f^i)+r[1]-1530992060|0)<<4|e>>>28)+n|0)^n^f)+r[4]+1272893353|0)<<11|i>>>21)+e|0)^e^n)+r[7]-155497632|0)<<16|f>>>16)+i|0)^i^e)+r[10]-1094730640|0)<<23|n>>>9)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n^f^i)+r[13]+681279174|0)<<4|e>>>28)+n|0)^n^f)+r[0]-358537222|0)<<11|i>>>21)+e|0)^e^n)+r[3]-722521979|0)<<16|f>>>16)+i|0)^i^e)+r[6]+76029189|0)<<23|n>>>9)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n^f^i)+r[9]-640364487|0)<<4|e>>>28)+n|0)^n^f)+r[12]-421815835|0)<<11|i>>>21)+e|0)^e^n)+r[15]+530742520|0)<<16|f>>>16)+i|0)^i^e)+r[2]-995338651|0)<<23|n>>>9)+f|0,n=((n+=((i=((i+=(n^((e=((e+=(f^(n|~i))+r[0]-198630844|0)<<6|e>>>26)+n|0)|~f))+r[7]+1126891415|0)<<10|i>>>22)+e|0)^((f=((f+=(e^(i|~n))+r[14]-1416354905|0)<<15|f>>>17)+i|0)|~e))+r[5]-57434055|0)<<21|n>>>11)+f|0,n=((n+=((i=((i+=(n^((e=((e+=(f^(n|~i))+r[12]+1700485571|0)<<6|e>>>26)+n|0)|~f))+r[3]-1894986606|0)<<10|i>>>22)+e|0)^((f=((f+=(e^(i|~n))+r[10]-1051523|0)<<15|f>>>17)+i|0)|~e))+r[1]-2054922799|0)<<21|n>>>11)+f|0,n=((n+=((i=((i+=(n^((e=((e+=(f^(n|~i))+r[8]+1873313359|0)<<6|e>>>26)+n|0)|~f))+r[15]-30611744|0)<<10|i>>>22)+e|0)^((f=((f+=(e^(i|~n))+r[6]-1560198380|0)<<15|f>>>17)+i|0)|~e))+r[13]+1309151649|0)<<21|n>>>11)+f|0,n=((n+=((i=((i+=(n^((e=((e+=(f^(n|~i))+r[4]-145523070|0)<<6|e>>>26)+n|0)|~f))+r[11]-1120210379|0)<<10|i>>>22)+e|0)^((f=((f+=(e^(i|~n))+r[2]+718787259|0)<<15|f>>>17)+i|0)|~e))+r[9]-343485551|0)<<21|n>>>11)+f|0,t[0]=e+t[0]|0,t[1]=n+t[1]|0,t[2]=f+t[2]|0,t[3]=i+t[3]|0}function n(t){var r,e=[];for(r=0;r<64;r+=4)e[r>>2]=t.charCodeAt(r)+(t.charCodeAt(r+1)<<8)+(t.charCodeAt(r+2)<<16)+(t.charCodeAt(r+3)<<24);return e}function f(t){var r,e=[];for(r=0;r<64;r+=4)e[r>>2]=t[r]+(t[r+1]<<8)+(t[r+2]<<16)+(t[r+3]<<24);return e}function i(t){var r,f,i,h,o,s,a=t.length,u=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=a;r+=64)e(u,n(t.substring(r-64,r)));for(f=(t=t.substring(r-64)).length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<f;r+=1)i[r>>2]|=t.charCodeAt(r)<<(r%4<<3);if(i[r>>2]|=128<<(r%4<<3),r>55)for(e(u,i),r=0;r<16;r+=1)i[r]=0;return h=(h=8*a).toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(h[2],16),s=parseInt(h[1],16)||0,i[14]=o,i[15]=s,e(u,i),u}function h(t){var e,n="";for(e=0;e<4;e+=1)n+=r[t>>8*e+4&15]+r[t>>8*e&15];return n}function o(t){var r;for(r=0;r<t.length;r+=1)t[r]=h(t[r]);return t.join("")}function s(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function a(t){var r,e=[],n=t.length;for(r=0;r<n-1;r+=2)e.push(parseInt(t.substr(r,2),16));return String.fromCharCode.apply(String,e)}function u(){this.reset()}return"5d41402abc4b2a76b9719d911017c592"!==o(i("hello"))&&function(t,r){var e=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(e>>16)<<16|65535&e},"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function r(t,r){return(t=0|t||0)<0?Math.max(t+r,0):Math.min(t,r)}ArrayBuffer.prototype.slice=function(e,n){var f,i,h,o,s=this.byteLength,a=r(e,s),u=s;return n!==t&&(u=r(n,s)),a>u?new ArrayBuffer(0):(f=u-a,i=new ArrayBuffer(f),h=new Uint8Array(i),o=new Uint8Array(this,a,f),h.set(o),i)}}(),u.prototype.append=function(t){return this.appendBinary(s(t)),this},u.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var r,f=this._buff.length;for(r=64;r<=f;r+=64)e(this._hash,n(this._buff.substring(r-64,r)));return this._buff=this._buff.substring(r-64),this},u.prototype.end=function(t){var r,e,n=this._buff,f=n.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<f;r+=1)i[r>>2]|=n.charCodeAt(r)<<(r%4<<3);return this._finish(i,f),e=o(this._hash),t&&(e=a(e)),this.reset(),e},u.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},u.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},u.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},u.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},u.prototype._finish=function(t,r){var n,f,i,h=r;if(t[h>>2]|=128<<(h%4<<3),h>55)for(e(this._hash,t),h=0;h<16;h+=1)t[h]=0;n=(n=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),f=parseInt(n[2],16),i=parseInt(n[1],16)||0,t[14]=f,t[15]=i,e(this._hash,t)},u.hash=function(t,r){return u.hashBinary(s(t),r)},u.hashBinary=function(t,r){var e=o(i(t));return r?a(e):e},u.ArrayBuffer=function(){this.reset()},u.ArrayBuffer.prototype.append=function(t){var r,n,i,h,o,s=(n=this._buff.buffer,i=t,h=!0,(o=new Uint8Array(n.byteLength+i.byteLength)).set(new Uint8Array(n)),o.set(new Uint8Array(i),n.byteLength),h?o:o.buffer),a=s.length;for(this._length+=t.byteLength,r=64;r<=a;r+=64)e(this._hash,f(s.subarray(r-64,r)));return this._buff=r-64<a?new Uint8Array(s.buffer.slice(r-64)):new Uint8Array(0),this},u.ArrayBuffer.prototype.end=function(t){var r,e,n=this._buff,f=n.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<f;r+=1)i[r>>2]|=n[r]<<(r%4<<3);return this._finish(i,f),e=o(this._hash),t&&(e=a(e)),this.reset(),e},u.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},u.ArrayBuffer.prototype.getState=function(){var t,r=u.prototype.getState.call(this);return r.buff=(t=r.buff,String.fromCharCode.apply(null,new Uint8Array(t))),r},u.ArrayBuffer.prototype.setState=function(t){return t.buff=function(t,r){var e,n=t.length,f=new ArrayBuffer(n),i=new Uint8Array(f);for(e=0;e<n;e+=1)i[e]=t.charCodeAt(e);return r?i:f}(t.buff,!0),u.prototype.setState.call(this,t)},u.ArrayBuffer.prototype.destroy=u.prototype.destroy,u.ArrayBuffer.prototype._finish=u.prototype._finish,u.ArrayBuffer.hash=function(t,r){var n=o(function(t){var r,n,i,h,o,s,a=t.length,u=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=a;r+=64)e(u,f(t.subarray(r-64,r)));for(n=(t=r-64<a?t.subarray(r-64):new Uint8Array(0)).length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<n;r+=1)i[r>>2]|=t[r]<<(r%4<<3);if(i[r>>2]|=128<<(r%4<<3),r>55)for(e(u,i),r=0;r<16;r+=1)i[r]=0;return h=(h=8*a).toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(h[2],16),s=parseInt(h[1],16)||0,i[14]=o,i[15]=s,e(u,i),u}(new Uint8Array(t)));return r?a(n):n},u});
},{}],"9d90":[function(require,module,exports) {
"use strict";function e(e,s,a){var r=a[a.length-1];e===r.element&&(a.pop(),r=a[a.length-1]);var n=r.element,t=r.index;if(Array.isArray(n))n.push(e);else if(t===s.length-2){n[s.pop()]=e}else s.push(e)}exports.stringify=function(e){var s=[];s.push({obj:e});for(var a,r,n,t,l,p,i,o,c,f,u="";a=s.pop();)if(r=a.obj,u+=a.prefix||"",n=a.val||"")u+=n;else if("object"!=typeof r)u+=void 0===r?null:JSON.stringify(r);else if(null===r)u+="null";else if(Array.isArray(r)){for(s.push({val:"]"}),t=r.length-1;t>=0;t--)l=0===t?"":",",s.push({obj:r[t],prefix:l});s.push({val:"["})}else{for(i in p=[],r)r.hasOwnProperty(i)&&p.push(i);for(s.push({val:"}"}),t=p.length-1;t>=0;t--)c=r[o=p[t]],f=t>0?",":"",f+=JSON.stringify(o)+":",s.push({obj:c,prefix:f});s.push({val:"{"})}return u},exports.parse=function(s){for(var a,r,n,t,l,p,i,o,c,f=[],u=[],h=0;;)if("}"!==(a=s[h++])&&"]"!==a&&void 0!==a)switch(a){case" ":case"\t":case"\n":case":":case",":break;case"n":h+=3,e(null,f,u);break;case"t":h+=3,e(!0,f,u);break;case"f":h+=4,e(!1,f,u);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(r="",h--;;){if(n=s[h++],!/[\d\.\-e\+]/.test(n)){h--;break}r+=n}e(parseFloat(r),f,u);break;case'"':for(t="",l=void 0,p=0;'"'!==(i=s[h++])||"\\"===l&&p%2==1;)t+=i,"\\"===(l=i)?p++:p=0;e(JSON.parse('"'+t+'"'),f,u);break;case"[":o={element:[],index:f.length},f.push(o.element),u.push(o);break;case"{":c={element:{},index:f.length},f.push(c.element),u.push(c);break;default:throw new Error("unexpectedly reached end of input: "+a)}else{if(1===f.length)return f.pop();e(f.pop(),f,u)}};
},{}],"uOR/":[function(require,module,exports) {
"use strict";function r(r){return function(){var t=arguments.length;if(t){for(var n=[],e=-1;++e<t;)n[e]=arguments[e];return r.call(this,n)}return r.call(this,[])}}module.exports=r;
},{}],"lZno":[function(require,module,exports) {
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};
},{}],"hAhw":[function(require,module,exports) {
"use strict";var e,t="object"==typeof Reflect?Reflect:null,n=t&&"function"==typeof t.apply?t.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};function r(e){console&&console.warn&&console.warn(e)}e=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}module.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function u(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function f(e,t,n,i){var o,s,f;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),f=s[t]),void 0===f)f=s[t]=n,++e._eventsCount;else if("function"==typeof f?f=s[t]=i?[n,f]:[f,n]:i?f.unshift(n):f.push(n),(o=u(e))>0&&f.length>o&&!f.warned){f.warned=!0;var p=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");p.name="MaxListenersExceededWarning",p.emitter=e,p.type=t,p.count=f.length,r(p)}return e}function p(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,n(this.listener,this.target,e))}function v(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=p.bind(r);return i.listener=n,r.wrapFn=i,i}function h(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?y(i):c(i,i.length)}function a(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function c(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function l(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function y(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var u=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw u.context=s,u}var f=o[e];if(void 0===f)return!1;if("function"==typeof f)n(f,this,t);else{var p=f.length,v=c(f,p);for(r=0;r<p;++r)n(v[r],this,t)}return!0},o.prototype.addListener=function(e,t){return f(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return f(this,e,t,!0)},o.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,v(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,v(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,s;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():l(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return h(this,e,!0)},o.prototype.rawListeners=function(e){return h(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):a.call(e,t)},o.prototype.listenerCount=a,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]};
},{}],"0nx4":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"8iXQ":[function(require,module,exports) {
var global = arguments[3];
var process = require("process");
var e=arguments[3],t=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n,r,i=l(require("immediate")),o=l(require("uuid")),a=l(require("spark-md5")),s=l(require("vuvuzela")),c=l(require("argsarray")),u=l(require("inherits")),f=require("events");function l(e){return e&&e.__esModule?e:{default:e}}function d(e){return"$"+e}function h(e){return e.substring(1)}function p(){this._store={}}function v(e){if(this._store=new p,e&&Array.isArray(e))for(var t=0,n=e.length;t<n;t++)this.add(e[t])}function _(){if("undefined"==typeof Symbol||"undefined"==typeof Map||"undefined"==typeof Set)return!1;var e=Object.getOwnPropertyDescriptor(Map,Symbol.species);return e&&"get"in e&&Map[Symbol.species]===Map}function g(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer||"undefined"!=typeof Blob&&e instanceof Blob}function y(e){if("function"==typeof e.slice)return e.slice(0);var t=new ArrayBuffer(e.byteLength),n=new Uint8Array(t),r=new Uint8Array(e);return n.set(r),t}function m(e){if(e instanceof ArrayBuffer)return y(e);var t=e.size,n=e.type;return"function"==typeof e.slice?e.slice(0,t,n):e.webkitSlice(0,t,n)}p.prototype.get=function(e){var t=d(e);return this._store[t]},p.prototype.set=function(e,t){var n=d(e);return this._store[n]=t,!0},p.prototype.has=function(e){return d(e)in this._store},p.prototype.delete=function(e){var t=d(e),n=t in this._store;return delete this._store[t],n},p.prototype.forEach=function(e){for(var t=Object.keys(this._store),n=0,r=t.length;n<r;n++){var i=t[n];e(this._store[i],i=h(i))}},Object.defineProperty(p.prototype,"size",{get:function(){return Object.keys(this._store).length}}),v.prototype.add=function(e){return this._store.set(e,!0)},v.prototype.has=function(e){return this._store.has(e)},v.prototype.forEach=function(e){this._store.forEach(function(t,n){e(n)})},Object.defineProperty(v.prototype,"size",{get:function(){return this._store.size}}),_()?(n=Set,r=Map):(n=v,r=p);var b=Function.prototype.toString,w=b.call(Object);function k(e){var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=t.constructor;return"function"==typeof n&&n instanceof n&&b.call(n)==w}function q(e){var t,n,r;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(t=[],n=0,r=e.length;n<r;n++)t[n]=q(e[n]);return t}if(e instanceof Date)return e.toISOString();if(g(e))return m(e);if(!k(e))return e;for(n in t={},e)if(Object.prototype.hasOwnProperty.call(e,n)){var i=q(e[n]);void 0!==i&&(t[n]=i)}return t}function j(e){var t=!1;return(0,c.default)(function(n){if(t)throw new Error("once called more than once");t=!0,e.apply(this,n)})}function O(e){return(0,c.default)(function(t){t=q(t);var n=this,r="function"==typeof t[t.length-1]&&t.pop(),i=new Promise(function(r,i){var o;try{var a=j(function(e,t){e?i(e):r(t)});t.push(a),(o=e.apply(n,t))&&"function"==typeof o.then&&r(o)}catch(s){i(s)}});return r&&i.then(function(e){r(null,e)},r),i})}function S(e,t,n){if(e.constructor.listeners("debug").length){for(var r=["api",e.name,t],i=0;i<n.length-1;i++)r.push(n[i]);e.constructor.emit("debug",r);var o=n[n.length-1];n[n.length-1]=function(n,r){var i=["api",e.name,t];i=i.concat(n?["error",n]:["success",r]),e.constructor.emit("debug",i),o(n,r)}}}function E(e,t){return O((0,c.default)(function(n){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var r=this;return S(r,e,n),this.taskqueue.isReady?t.apply(this,n):new Promise(function(t,i){r.taskqueue.addTask(function(o){o?i(o):t(r[e].apply(r,n))})})}))}function A(e,t){for(var n={},r=0,i=t.length;r<i;r++){var o=t[r];o in e&&(n[o]=e[o])}return n}var x,P,C=6;function $(e){return e}function D(e){return[{ok:e}]}function I(e,t,n){var i=t.docs,o=new r;i.forEach(function(e){o.has(e.id)?o.get(e.id).push(e):o.set(e.id,[e])});var a=o.size,s=0,c=new Array(a);function u(){var e;++s===a&&(e=[],c.forEach(function(t){t.docs.forEach(function(n){e.push({id:t.id,docs:[n]})})}),n(null,{results:e}))}var f=[];o.forEach(function(e,t){f.push(t)});var l=0;function d(){if(!(l>=f.length)){var n=Math.min(l+C,f.length),r=f.slice(l,n);!function(n,r){n.forEach(function(n,i){var a=r+i,s=o.get(n),f=A(s[0],["atts_since","attachments"]);f.open_revs=s.map(function(e){return e.rev}),f.open_revs=f.open_revs.filter($);var l=$;0===f.open_revs.length&&(delete f.open_revs,l=D),["revs","attachments","binary","ajax","latest"].forEach(function(e){e in t&&(f[e]=t[e])}),e.get(n,f,function(e,t){var r,i,o;r=e?[{error:e}]:l(t),i=n,o=r,c[a]={id:i,docs:o},u(),d()})})}(r,l),l+=r.length}}d()}try{localStorage.setItem("_pouch_check_localstorage",1),x=!!localStorage.getItem("_pouch_check_localstorage")}catch(mo){x=!1}function L(){return x}function B(e){L()&&addEventListener("storage",function(t){e.emit(t.key)})}function R(){f.EventEmitter.call(this),this._listeners={},B(this)}function T(e){if("undefined"!=typeof console&&"function"==typeof console[e]){var t=Array.prototype.slice.call(arguments,1);console[e].apply(console,t)}}function N(e,t){return e=parseInt(e,10)||0,(t=parseInt(t,10))!=t||t<=e?t=(e||1)<<1:t+=1,t>6e5&&(e=3e5,t=6e5),~~((t-e)*Math.random()+e)}function M(e){var t=0;return e||(t=2e3),N(e,t)}function K(e,t){T("info","The above "+e+" is totally normal. "+t)}(0,u.default)(R,f.EventEmitter),R.prototype.addListener=function(e,t,n,r){if(!this._listeners[t]){var o=this,a=!1;this._listeners[t]=s,this.on(e,s)}function s(){if(o._listeners[t])if(a)a="waiting";else{a=!0;var e=A(r,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);n.changes(e).on("change",function(e){e.seq>r.since&&!r.cancelled&&(r.since=e.seq,r.onChange(e))}).on("complete",function(){"waiting"===a&&(0,i.default)(s),a=!1}).on("error",function(){a=!1})}}},R.prototype.removeListener=function(e,t){t in this._listeners&&(f.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t]),delete this._listeners[t])},R.prototype.notifyLocalWindows=function(e){L()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},R.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)};var J=P="function"==typeof Object.assign?Object.assign:function(e){for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t};function z(e,t,n){Error.call(this,n),this.status=e,this.name=t,this.message=n,this.error=!0}(0,u.default)(z,Error),z.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var F=new z(401,"unauthorized","Name or password is incorrect."),U=new z(400,"bad_request","Missing JSON list of 'docs'"),G=new z(404,"not_found","missing"),Q=new z(409,"conflict","Document update conflict"),V=new z(400,"bad_request","_id field must contain a string"),W=new z(412,"missing_id","_id is required for puts"),Y=new z(400,"bad_request","Only reserved document ids may start with underscore."),H=new z(412,"precondition_failed","Database not open"),X=new z(500,"unknown_error","Database encountered an unknown error"),Z=new z(500,"badarg","Some query argument is invalid"),ee=new z(400,"invalid_request","Request was invalid"),te=new z(400,"query_parse_error","Some query parameter is invalid"),ne=new z(500,"doc_validation","Bad special document member"),re=new z(400,"bad_request","Something wrong with the request"),ie=new z(400,"bad_request","Document must be a JSON object"),oe=new z(404,"not_found","Database not found"),ae=new z(500,"indexed_db_went_bad","unknown"),se=new z(500,"web_sql_went_bad","unknown"),ce=new z(500,"levelDB_went_went_bad","unknown"),ue=new z(403,"forbidden","Forbidden by design doc validate_doc_update function"),fe=new z(400,"bad_request","Invalid rev format"),le=new z(412,"file_exists","The database could not be created, the file already exists."),de=new z(412,"missing_stub","A pre-existing attachment stub wasn't found"),he=new z(413,"invalid_url","Provided URL is invalid");function pe(e,t){function n(t){for(var n in e)"function"!=typeof e[n]&&(this[n]=e[n]);void 0!==t&&(this.reason=t)}return n.prototype=z.prototype,new n(t)}function ve(e){if("object"!=typeof e){var t=e;(e=X).data=t}return"error"in e&&"conflict"===e.error&&(e.name="conflict",e.status=409),"name"in e||(e.name=e.error||"unknown"),"status"in e||(e.status=500),"message"in e||(e.message=e.message||e.reason),e}function _e(e,t,n){try{return!e(t,n)}catch(i){var r="Filter function threw: "+i.toString();return pe(re,r)}}function ge(e){var t={},n=e.filter&&"function"==typeof e.filter;return t.query=e.query_params,function(r){r.doc||(r.doc={});var i=n&&_e(e.filter,r.doc,t);if("object"==typeof i)return i;if(i)return!1;if(e.include_docs){if(!e.attachments)for(var o in r.doc._attachments)r.doc._attachments.hasOwnProperty(o)&&(r.doc._attachments[o].stub=!0)}else delete r.doc;return!0}}function ye(e){for(var t=[],n=0,r=e.length;n<r;n++)t=t.concat(e[n]);return t}function me(e){var t;if(e?"string"!=typeof e?t=pe(V):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=pe(Y)):t=pe(W),t)throw t}function be(e){return"boolean"==typeof e._remote?e._remote:"function"==typeof e.type&&(T("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===e.type())}function we(e,t){return"listenerCount"in e?e.listenerCount(t):f.EventEmitter.listenerCount(e,t)}function ke(e){if(!e)return null;var t=e.split("/");return 2===t.length?t:1===t.length?[e,e]:null}function qe(e){var t=ke(e);return t?t.join("/"):null}var je=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],Oe="queryKey",Se=/(?:^|&)([^&=]*)=?([^&]*)/g,Ee=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;function Ae(e){for(var t=Ee.exec(e),n={},r=14;r--;){var i=je[r],o=t[r]||"",a=-1!==["user","password"].indexOf(i);n[i]=a?decodeURIComponent(o):o}return n[Oe]={},n[je[12]].replace(Se,function(e,t,r){t&&(n[Oe][t]=r)}),n}function xe(e,t){var n=[],r=[];for(var i in t)t.hasOwnProperty(i)&&(n.push(i),r.push(t[i]));return n.push(e),Function.apply(null,n).apply(null,r)}function Pe(e,t,n){return new Promise(function(r,i){e.get(t,function(o,a){if(o){if(404!==o.status)return i(o);a={}}var s=a._rev,c=n(a);if(!c)return r({updated:!1,rev:s});c._id=t,c._rev=s,r(Ce(e,c,n))})})}function Ce(e,t,n){return e.put(t).then(function(e){return{updated:!0,rev:e.rev}},function(r){if(409!==r.status)throw r;return Pe(e,t._id,n)})}var $e=function(e){return atob(e)},De=function(e){return btoa(e)};function Ie(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(mo){if("TypeError"!==mo.name)throw mo;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}function Le(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e.charCodeAt(i);return n}function Be(e,t){return Ie([Le(e)],{type:t})}function Re(e,t){return Be($e(e),t)}function Te(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,i=0;i<r;i++)t+=String.fromCharCode(n[i]);return t}function Ne(e,t){var n=new FileReader,r="function"==typeof n.readAsBinaryString;n.onloadend=function(e){var n=e.target.result||"";if(r)return t(n);t(Te(n))},r?n.readAsBinaryString(e):n.readAsArrayBuffer(e)}function Me(e,t){Ne(e,function(e){t(e)})}function Ke(e,t){Me(e,function(e){t(De(e))})}function Je(e,t){var n=new FileReader;n.onloadend=function(e){var n=e.target.result||new ArrayBuffer(0);t(n)},n.readAsArrayBuffer(e)}var ze=e.setImmediate||e.setTimeout,Fe=32768;function Ue(e){return De(e)}function Ge(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.slice(t,n)}function Qe(e,t,n,r,i){(n>0||r<t.size)&&(t=Ge(t,n,r)),Je(t,function(t){e.append(t),i()})}function Ve(e,t,n,r,i){(n>0||r<t.length)&&(t=t.substring(n,r)),e.appendBinary(t),i()}function We(e,t){var n="string"==typeof e,r=n?e.length:e.size,i=Math.min(Fe,r),o=Math.ceil(r/i),s=0,c=n?new a.default:new a.default.ArrayBuffer,u=n?Ve:Qe;function f(){ze(d)}function l(){var e=Ue(c.end(!0));t(e),c.destroy()}function d(){var t=s*i,n=t+i;u(c,e,t,n,++s<o?f:l)}d()}function Ye(e){return a.default.hash(e)}function He(e,t){var n=q(e);return t?(delete n._rev_tree,Ye(JSON.stringify(n))):o.default.v4().replace(/-/g,"").toLowerCase()}var Xe=o.default.v4;function Ze(e){for(var t,n,r,i,o=e.rev_tree.slice();i=o.pop();){var a=i.ids,s=a[2],c=i.pos;if(s.length)for(var u=0,f=s.length;u<f;u++)o.push({pos:c+1,ids:s[u]});else{var l=!!a[1].deleted,d=a[0];t&&!(r!==l?r:n!==c?n<c:t<d)||(t=d,n=c,r=l)}}return n+"-"+t}function et(e,t){for(var n,r=e.slice();n=r.pop();)for(var i=n.pos,o=n.ids,a=o[2],s=t(0===a.length,i,o[0],n.ctx,o[1]),c=0,u=a.length;c<u;c++)r.push({pos:i+1,ids:a[c],ctx:s})}function tt(e,t){return e.pos-t.pos}function nt(e){var t=[];et(e,function(e,n,r,i,o){e&&t.push({rev:n+"-"+r,pos:n,opts:o})}),t.sort(tt).reverse();for(var n=0,r=t.length;n<r;n++)delete t[n].pos;return t}function rt(e){for(var t=Ze(e),n=nt(e.rev_tree),r=[],i=0,o=n.length;i<o;i++){var a=n[i];a.rev===t||a.opts.deleted||r.push(a.rev)}return r}function it(e){var t=[];return et(e.rev_tree,function(e,n,r,i,o){"available"!==o.status||e||(t.push(n+"-"+r),o.status="missing")}),t}function ot(e){for(var t,n=[],r=e.slice();t=r.pop();){var i=t.pos,o=t.ids,a=o[0],s=o[1],c=o[2],u=0===c.length,f=t.history?t.history.slice():[];f.push({id:a,opts:s}),u&&n.push({pos:i+1-f.length,ids:f});for(var l=0,d=c.length;l<d;l++)r.push({pos:i+1,ids:c[l],history:f})}return n.reverse()}function at(e,t){return e.pos-t.pos}function st(e,t,n){for(var r,i=0,o=e.length;i<o;)n(e[r=i+o>>>1],t)<0?i=r+1:o=r;return i}function ct(e,t,n){var r=st(e,t,n);e.splice(r,0,t)}function ut(e,t){for(var n,r,i=t,o=e.length;i<o;i++){var a=e[i],s=[a.id,a.opts,[]];r?(r[2].push(s),r=s):n=r=s}return n}function ft(e,t){return e[0]<t[0]?-1:1}function lt(e,t){for(var n=[{tree1:e,tree2:t}],r=!1;n.length>0;){var i=n.pop(),o=i.tree1,a=i.tree2;(o[1].status||a[1].status)&&(o[1].status="available"===o[1].status||"available"===a[1].status?"available":"missing");for(var s=0;s<a[2].length;s++)if(o[2][0]){for(var c=!1,u=0;u<o[2].length;u++)o[2][u][0]===a[2][s][0]&&(n.push({tree1:o[2][u],tree2:a[2][s]}),c=!0);c||(r="new_branch",ct(o[2],a[2][s],ft))}else r="new_leaf",o[2][0]=a[2][s]}return{conflicts:r,tree:e}}function dt(e,t,n){var r,i=[],o=!1,a=!1;if(!e.length)return{tree:[t],conflicts:"new_leaf"};for(var s=0,c=e.length;s<c;s++){var u=e[s];if(u.pos===t.pos&&u.ids[0]===t.ids[0])r=lt(u.ids,t.ids),i.push({pos:u.pos,ids:r.tree}),o=o||r.conflicts,a=!0;else if(!0!==n){var f=u.pos<t.pos?u:t,l=u.pos<t.pos?t:u,d=l.pos-f.pos,h=[],p=[];for(p.push({ids:f.ids,diff:d,parent:null,parentIdx:null});p.length>0;){var v=p.pop();if(0!==v.diff)for(var _=v.ids[2],g=0,y=_.length;g<y;g++)p.push({ids:_[g],diff:v.diff-1,parent:v.ids,parentIdx:g});else v.ids[0]===l.ids[0]&&h.push(v)}var m=h[0];m?(r=lt(m.ids,l.ids),m.parent[2][m.parentIdx]=r.tree,i.push({pos:f.pos,ids:f.ids}),o=o||r.conflicts,a=!0):i.push(u)}else i.push(u)}return a||i.push(t),i.sort(at),{tree:i,conflicts:o||"internal_node"}}function ht(e,t){for(var n,r,i=ot(e),o=0,a=i.length;o<a;o++){var s,c=i[o],u=c.ids;if(u.length>t){n||(n={});var f=u.length-t;s={pos:c.pos+f,ids:ut(u,f)};for(var l=0;l<f;l++){var d=c.pos+l+"-"+u[l].id;n[d]=!0}}else s={pos:c.pos,ids:ut(u,0)};r=r?dt(r,s,!0).tree:[s]}return n&&et(r,function(e,t,r){delete n[t+"-"+r]}),{tree:r,revs:n?Object.keys(n):[]}}function pt(e,t,n){var r=dt(e,t),i=ht(r.tree,n);return{tree:i.tree,stemmedRevs:i.revs,conflicts:r.conflicts}}function vt(e,t){for(var n,r=e.slice(),i=t.split("-"),o=parseInt(i[0],10),a=i[1];n=r.pop();){if(n.pos===o&&n.ids[0]===a)return!0;for(var s=n.ids[2],c=0,u=s.length;c<u;c++)r.push({pos:n.pos+1,ids:s[c]})}return!1}function _t(e){return e.ids}function gt(e,t){t||(t=Ze(e));for(var n,r=t.substring(t.indexOf("-")+1),i=e.rev_tree.map(_t);n=i.pop();){if(n[0]===r)return!!n[1].deleted;i=i.concat(n[2])}}function yt(e){return/^_local/.test(e)}function mt(e,t){for(var n,r=t.rev_tree.slice();n=r.pop();){var i=n.pos,o=n.ids,a=o[0],s=o[1],c=o[2],u=0===c.length,f=n.history?n.history.slice():[];if(f.push({id:a,pos:i,opts:s}),u)for(var l=0,d=f.length;l<d;l++){var h=f[l];if(h.pos+"-"+h.id===e)return i+"-"+a}for(var p=0,v=c.length;p<v;p++)r.push({pos:i+1,ids:c[p],history:f})}throw new Error("Unable to resolve latest revision for id "+t.id+", rev "+e)}function bt(e,t,n,r){try{e.emit("change",t,n,r)}catch(mo){T("error",'Error in .on("change", function):',mo)}}function wt(e,t,n){f.EventEmitter.call(this);var r=this;this.db=e;var i=(t=t?q(t):{}).complete=j(function(t,n){t?we(r,"error")>0&&r.emit("error",t):r.emit("complete",n),r.removeAllListeners(),e.removeListener("destroyed",o)});function o(){r.cancel()}n&&(r.on("complete",function(e){n(null,e)}),r.on("error",n)),e.once("destroyed",o),t.onChange=function(e,t,n){r.isCancelled||bt(r,e,t,n)};var a=new Promise(function(e,n){t.complete=function(t,r){t?n(t):e(r)}});r.once("cancel",function(){e.removeListener("destroyed",o),t.complete(null,{status:"cancelled"})}),this.then=a.then.bind(a),this.catch=a.catch.bind(a),this.then(function(e){i(null,e)},i),e.taskqueue.isReady?r.validateChanges(t):e.taskqueue.addTask(function(e){e?t.complete(e):r.isCancelled?r.emit("cancel"):r.validateChanges(t)})}function kt(e,t,n){var r=[{rev:e._rev}];"all_docs"===n.style&&(r=nt(t.rev_tree).map(function(e){return{rev:e.rev}}));var i={id:t.id,changes:r,doc:e};return gt(t,e._rev)&&(i.deleted=!0),n.conflicts&&(i.doc._conflicts=rt(t),i.doc._conflicts.length||delete i.doc._conflicts),i}function qt(e,t){return e<t?-1:e>t?1:0}function jt(e,t){return function(n,r){n||r[0]&&r[0].error?((n=n||r[0]).docId=t,e(n)):e(null,r.length?r[0]:r)}}function Ot(e){for(var t=0;t<e.length;t++){var n=e[t];if(n._deleted)delete n._attachments;else if(n._attachments)for(var r=Object.keys(n._attachments),i=0;i<r.length;i++){var o=r[i];n._attachments[o]=A(n._attachments[o],["data","digest","content_type","length","revpos","stub"])}}}function St(e,t){var n=qt(e._id,t._id);return 0!==n?n:qt(e._revisions?e._revisions.start:0,t._revisions?t._revisions.start:0)}function Et(e){var t={},n=[];return et(e,function(e,r,i,o){var a=r+"-"+i;return e&&(t[a]=0),void 0!==o&&n.push({from:o,to:a}),a}),n.reverse(),n.forEach(function(e){void 0===t[e.from]?t[e.from]=1+t[e.to]:t[e.from]=Math.min(t[e.from],1+t[e.to])}),t}function At(e){var t="limit"in e?e.keys.slice(e.skip,e.limit+e.skip):e.skip>0?e.keys.slice(e.skip):e.keys;e.keys=t,e.skip=0,delete e.limit,e.descending&&(t.reverse(),e.descending=!1)}function xt(e){var t=e._compactionQueue[0],n=t.opts,r=t.callback;e.get("_local/compaction").catch(function(){return!1}).then(function(t){t&&t.last_seq&&(n.last_seq=t.last_seq),e._compact(n,function(t,n){t?r(t):r(null,n),(0,i.default)(function(){e._compactionQueue.shift(),e._compactionQueue.length&&xt(e)})})})}function Pt(e){return"_"===e.charAt(0)&&e+" is not a valid attachment name, attachment names cannot start with '_'"}function Ct(){for(var e in f.EventEmitter.call(this),Ct.prototype)"function"==typeof this[e]&&(this[e]=this[e].bind(this))}function $t(){this.isReady=!1,this.failed=!1,this.queue=[]}function Dt(e,t){var n=e.match(/([a-z-]*):\/\/(.*)/);if(n)return{name:/https?/.test(n[1])?n[1]+"://"+n[2]:n[2],adapter:n[1]};var r=Lt.adapters,i=Lt.preferredAdapters,o=Lt.prefix,a=t.adapter;if(!a)for(var s=0;s<i.length&&("idb"===(a=i[s])&&"websql"in r&&L()&&localStorage["_pouch__websqldb_"+o+e]);++s)T("log",'PouchDB is downgrading "'+e+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');var c=r[a];return{name:!(c&&"use_prefix"in c)||c.use_prefix?o+e:e,adapter:a}}function It(e){function t(t){e.removeListener("closed",n),t||e.constructor.emit("destroyed",e.name)}function n(){e.removeListener("destroyed",t),e.constructor.emit("unref",e)}e.once("destroyed",t),e.once("closed",n),e.constructor.emit("ref",e)}function Lt(e,t){if(!(this instanceof Lt))return new Lt(e,t);var n=this;if(t=t||{},e&&"object"==typeof e&&(e=(t=e).name,delete t.name),void 0===t.deterministic_revs&&(t.deterministic_revs=!0),this.__opts=t=q(t),n.auto_compaction=t.auto_compaction,n.prefix=Lt.prefix,"string"!=typeof e)throw new Error("Missing/invalid DB name");var r=Dt((t.prefix||"")+e,t);if(t.name=r.name,t.adapter=t.adapter||r.adapter,n.name=e,n._adapter=t.adapter,Lt.emit("debug",["adapter","Picked adapter: ",t.adapter]),!Lt.adapters[t.adapter]||!Lt.adapters[t.adapter].valid())throw new Error("Invalid Adapter: "+t.adapter);Ct.call(n),n.taskqueue=new $t,n.adapter=t.adapter,Lt.adapters[t.adapter].call(n,t,function(e){if(e)return n.taskqueue.fail(e);It(n),n.emit("created",n),Lt.emit("created",n.name),n.taskqueue.ready(n)})}(0,u.default)(wt,f.EventEmitter),wt.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},wt.prototype.validateChanges=function(e){var t=e.complete,n=this;Lt._changesFilterPlugin?Lt._changesFilterPlugin.validate(e,function(r){if(r)return t(r);n.doChanges(e)}):n.doChanges(e)},wt.prototype.doChanges=function(e){var t=this,n=e.complete;if("live"in(e=q(e))&&!("continuous"in e)&&(e.continuous=e.live),e.processChange=kt,"latest"===e.since&&(e.since="now"),e.since||(e.since=0),"now"!==e.since){if(Lt._changesFilterPlugin){if(Lt._changesFilterPlugin.normalize(e),Lt._changesFilterPlugin.shouldFilter(this,e))return Lt._changesFilterPlugin.filter(this,e)}else["doc_ids","filter","selector","view"].forEach(function(t){t in e&&T("warn",'The "'+t+'" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.')});"descending"in e||(e.descending=!1),e.limit=0===e.limit?1:e.limit,e.complete=n;var r=this.db._changes(e);if(r&&"function"==typeof r.cancel){var i=t.cancel;t.cancel=(0,c.default)(function(e){r.cancel(),i.apply(this,e)})}}else this.db.info().then(function(r){t.isCancelled?n(null,{status:"cancelled"}):(e.since=r.update_seq,t.doChanges(e))},n)},(0,u.default)(Ct,f.EventEmitter),Ct.prototype.post=E("post",function(e,t,n){if("function"==typeof t&&(n=t,t={}),"object"!=typeof e||Array.isArray(e))return n(pe(ie));this.bulkDocs({docs:[e]},t,jt(n,e._id))}),Ct.prototype.put=E("put",function(e,t,n){if("function"==typeof t&&(n=t,t={}),"object"!=typeof e||Array.isArray(e))return n(pe(ie));if(me(e._id),yt(e._id)&&"function"==typeof this._putLocal)return e._deleted?this._removeLocal(e,n):this._putLocal(e,n);var r,i,o,a,s=this;function c(n){"function"==typeof s._put&&!1!==t.new_edits?s._put(e,t,n):s.bulkDocs({docs:[e]},t,jt(n,e._id))}t.force&&e._rev?(r=e._rev.split("-"),i=r[1],o=parseInt(r[0],10)+1,a=He(),e._revisions={start:o,ids:[a,i]},e._rev=o+"-"+a,t.new_edits=!1,c(function(t){var r=t?null:{ok:!0,id:e._id,rev:e._rev};n(t,r)})):c(n)}),Ct.prototype.putAttachment=E("putAttachment",function(e,t,n,r,i){var o=this;function a(e){var n="_rev"in e?parseInt(e._rev,10):0;return e._attachments=e._attachments||{},e._attachments[t]={content_type:i,data:r,revpos:++n},o.put(e)}return"function"==typeof i&&(i=r,r=n,n=null),void 0===i&&(i=r,r=n,n=null),i||T("warn","Attachment",t,"on document",e,"is missing content_type"),o.get(e).then(function(e){if(e._rev!==n)throw pe(Q);return a(e)},function(t){if(t.reason===G.message)return a({_id:e});throw t})}),Ct.prototype.removeAttachment=E("removeAttachment",function(e,t,n,r){var i=this;i.get(e,function(e,o){if(e)r(e);else if(o._rev===n){if(!o._attachments)return r();delete o._attachments[t],0===Object.keys(o._attachments).length&&delete o._attachments,i.put(o,r)}else r(pe(Q))})}),Ct.prototype.remove=E("remove",function(e,t,n,r){var i;"string"==typeof t?(i={_id:e,_rev:t},"function"==typeof n&&(r=n,n={})):(i=e,"function"==typeof t?(r=t,n={}):(r=n,n=t)),(n=n||{}).was_delete=!0;var o={_id:i._id,_rev:i._rev||n.rev,_deleted:!0};if(yt(o._id)&&"function"==typeof this._removeLocal)return this._removeLocal(i,r);this.bulkDocs({docs:[o]},n,jt(r,o._id))}),Ct.prototype.revsDiff=E("revsDiff",function(e,t,n){"function"==typeof t&&(n=t,t={});var i=Object.keys(e);if(!i.length)return n(null,{});var o=0,a=new r;function s(e,t){a.has(e)||a.set(e,{missing:[]}),a.get(e).missing.push(t)}i.map(function(t){this._getRevisionTree(t,function(r,c){if(r&&404===r.status&&"missing"===r.message)a.set(t,{missing:e[t]});else{if(r)return n(r);!function(t,n){var r=e[t].slice(0);et(n,function(e,n,i,o,a){var c=n+"-"+i,u=r.indexOf(c);-1!==u&&(r.splice(u,1),"available"!==a.status&&s(t,c))}),r.forEach(function(e){s(t,e)})}(t,c)}if(++o===i.length){var u={};return a.forEach(function(e,t){u[t]=e}),n(null,u)}})},this)}),Ct.prototype.bulkGet=E("bulkGet",function(e,t){I(this,e,t)}),Ct.prototype.compactDocument=E("compactDocument",function(e,t,n){var r=this;this._getRevisionTree(e,function(i,o){if(i)return n(i);var a=Et(o),s=[],c=[];Object.keys(a).forEach(function(e){a[e]>t&&s.push(e)}),et(o,function(e,t,n,r,i){var o=t+"-"+n;"available"===i.status&&-1!==s.indexOf(o)&&c.push(o)}),r._doCompaction(e,c,n)})}),Ct.prototype.compact=E("compact",function(e,t){"function"==typeof e&&(t=e,e={});e=e||{},this._compactionQueue=this._compactionQueue||[],this._compactionQueue.push({opts:e,callback:t}),1===this._compactionQueue.length&&xt(this)}),Ct.prototype._compact=function(e,t){var n=this,r={return_docs:!1,last_seq:e.last_seq||0},i=[];n.changes(r).on("change",function(e){i.push(n.compactDocument(e.id,0))}).on("complete",function(e){var r=e.last_seq;Promise.all(i).then(function(){return Pe(n,"_local/compaction",function(e){return(!e.last_seq||e.last_seq<r)&&(e.last_seq=r,e)})}).then(function(){t(null,{ok:!0})}).catch(t)}).on("error",t)},Ct.prototype.get=E("get",function(e,t,n){if("function"==typeof t&&(n=t,t={}),"string"!=typeof e)return n(pe(V));if(yt(e)&&"function"==typeof this._getLocal)return this._getLocal(e,n);var r=[],i=this;function o(){var o=[],a=r.length;if(!a)return n(null,o);r.forEach(function(r){i.get(e,{rev:r,revs:t.revs,latest:t.latest,attachments:t.attachments,binary:t.binary},function(e,t){if(e)o.push({missing:r});else{for(var i,s=0,c=o.length;s<c;s++)if(o[s].ok&&o[s].ok._rev===t._rev){i=!0;break}i||o.push({ok:t})}--a||n(null,o)})})}if(!t.open_revs)return this._get(e,t,function(r,o){if(r)return r.docId=e,n(r);var a=o.doc,s=o.metadata,c=o.ctx;if(t.conflicts){var u=rt(s);u.length&&(a._conflicts=u)}if(gt(s,a._rev)&&(a._deleted=!0),t.revs||t.revs_info){for(var f=a._rev.split("-"),l=parseInt(f[0],10),d=f[1],h=ot(s.rev_tree),p=null,v=0;v<h.length;v++){var _=h[v],g=_.ids.map(function(e){return e.id}).indexOf(d);(g===l-1||!p&&-1!==g)&&(p=_)}if(!p)return(r=new Error("invalid rev tree")).docId=e,n(r);var y=p.ids.map(function(e){return e.id}).indexOf(a._rev.split("-")[1])+1,m=p.ids.length-y;if(p.ids.splice(y,m),p.ids.reverse(),t.revs&&(a._revisions={start:p.pos+p.ids.length-1,ids:p.ids.map(function(e){return e.id})}),t.revs_info){var b=p.pos+p.ids.length;a._revs_info=p.ids.map(function(e){return{rev:--b+"-"+e.id,status:e.opts.status}})}}if(t.attachments&&a._attachments){var w=a._attachments,k=Object.keys(w).length;if(0===k)return n(null,a);Object.keys(w).forEach(function(e){this._getAttachment(a._id,e,w[e],{rev:a._rev,binary:t.binary,ctx:c},function(t,r){var i=a._attachments[e];i.data=r,delete i.stub,delete i.length,--k||n(null,a)})},i)}else{if(a._attachments)for(var q in a._attachments)a._attachments.hasOwnProperty(q)&&(a._attachments[q].stub=!0);n(null,a)}});if("all"===t.open_revs)this._getRevisionTree(e,function(e,t){if(e)return n(e);r=nt(t).map(function(e){return e.rev}),o()});else{if(!Array.isArray(t.open_revs))return n(pe(X,"function_clause"));r=t.open_revs;for(var a=0;a<r.length;a++){var s=r[a];if("string"!=typeof s||!/^\d+-/.test(s))return n(pe(fe))}o()}}),Ct.prototype.getAttachment=E("getAttachment",function(e,t,n,r){var i=this;n instanceof Function&&(r=n,n={}),this._get(e,n,function(o,a){return o?r(o):a.doc._attachments&&a.doc._attachments[t]?(n.ctx=a.ctx,n.binary=!0,void i._getAttachment(e,t,a.doc._attachments[t],n,r)):r(pe(G))})}),Ct.prototype.allDocs=E("allDocs",function(e,t){if("function"==typeof e&&(t=e,e={}),e.skip=void 0!==e.skip?e.skip:0,e.start_key&&(e.startkey=e.start_key),e.end_key&&(e.endkey=e.end_key),"keys"in e){if(!Array.isArray(e.keys))return t(new TypeError("options.keys must be an array"));var n=["startkey","endkey","key"].filter(function(t){return t in e})[0];if(n)return void t(pe(te,"Query parameter `"+n+"` is not compatible with multi-get"));if(!be(this)&&(At(e),0===e.keys.length))return this._allDocs({limit:0},t)}return this._allDocs(e,t)}),Ct.prototype.changes=function(e,t){return"function"==typeof e&&(t=e,e={}),(e=e||{}).return_docs="return_docs"in e?e.return_docs:!e.live,new wt(this,e,t)},Ct.prototype.close=E("close",function(e){return this._closed=!0,this.emit("closed"),this._close(e)}),Ct.prototype.info=E("info",function(e){var t=this;this._info(function(n,r){if(n)return e(n);r.db_name=r.db_name||t.name,r.auto_compaction=!(!t.auto_compaction||be(t)),r.adapter=t.adapter,e(null,r)})}),Ct.prototype.id=E("id",function(e){return this._id(e)}),Ct.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},Ct.prototype.bulkDocs=E("bulkDocs",function(e,t,n){if("function"==typeof t&&(n=t,t={}),t=t||{},Array.isArray(e)&&(e={docs:e}),!e||!e.docs||!Array.isArray(e.docs))return n(pe(U));for(var r=0;r<e.docs.length;++r)if("object"!=typeof e.docs[r]||Array.isArray(e.docs[r]))return n(pe(ie));var i;if(e.docs.forEach(function(e){e._attachments&&Object.keys(e._attachments).forEach(function(t){i=i||Pt(t),e._attachments[t].content_type||T("warn","Attachment",t,"on document",e._id,"is missing content_type")})}),i)return n(pe(re,i));"new_edits"in t||(t.new_edits=!("new_edits"in e)||e.new_edits);var o=this;t.new_edits||be(o)||e.docs.sort(St),Ot(e.docs);var a=e.docs.map(function(e){return e._id});return this._bulkDocs(e,t,function(e,r){if(e)return n(e);if(t.new_edits||(r=r.filter(function(e){return e.error})),!be(o))for(var i=0,s=r.length;i<s;i++)r[i].id=r[i].id||a[i];n(null,r)})}),Ct.prototype.registerDependentDatabase=E("registerDependentDatabase",function(e,t){var n=new this.constructor(e,this.__opts);Pe(this,"_local/_pouch_dependentDbs",function(t){return t.dependentDbs=t.dependentDbs||{},!t.dependentDbs[e]&&(t.dependentDbs[e]=!0,t)}).then(function(){t(null,{db:n})}).catch(t)}),Ct.prototype.destroy=E("destroy",function(e,t){"function"==typeof e&&(t=e,e={});var n=this,r=!("use_prefix"in n)||n.use_prefix;function i(){n._destroy(e,function(e,r){if(e)return t(e);n._destroyed=!0,n.emit("destroyed"),t(null,r||{ok:!0})})}if(be(n))return i();n.get("_local/_pouch_dependentDbs",function(e,o){if(e)return 404!==e.status?t(e):i();var a=o.dependentDbs,s=n.constructor,c=Object.keys(a).map(function(e){var t=r?e.replace(new RegExp("^"+s.prefix),""):e;return new s(t,n.__opts).destroy()});Promise.all(c).then(i,t)})}),$t.prototype.execute=function(){var e;if(this.failed)for(;e=this.queue.shift();)e(this.failed);else for(;e=this.queue.shift();)e()},$t.prototype.fail=function(e){this.failed=e,this.execute()},$t.prototype.ready=function(e){this.isReady=!0,this.db=e,this.execute()},$t.prototype.addTask=function(e){this.queue.push(e),this.failed&&this.execute()},(0,u.default)(Lt,Ct);var Bt="undefined"!=typeof AbortController?AbortController:function(){return{abort:function(){}}},Rt=fetch,Tt=Headers;Lt.adapters={},Lt.preferredAdapters=[],Lt.prefix="_pouch_";var Nt=new f.EventEmitter;function Mt(e){Object.keys(f.EventEmitter.prototype).forEach(function(t){"function"==typeof f.EventEmitter.prototype[t]&&(e[t]=Nt[t].bind(Nt))});var t=e._destructionListeners=new r;e.on("ref",function(e){t.has(e.name)||t.set(e.name,[]),t.get(e.name).push(e)}),e.on("unref",function(e){if(t.has(e.name)){var n=t.get(e.name),r=n.indexOf(e);r<0||(n.splice(r,1),n.length>1?t.set(e.name,n):t.delete(e.name))}}),e.on("destroyed",function(e){if(t.has(e)){var n=t.get(e);t.delete(e),n.forEach(function(e){e.emit("destroyed",!0)})}})}Mt(Lt),Lt.adapter=function(e,t,n){t.valid()&&(Lt.adapters[e]=t,n&&Lt.preferredAdapters.push(e))},Lt.plugin=function(e){if("function"==typeof e)e(Lt);else{if("object"!=typeof e||0===Object.keys(e).length)throw new Error('Invalid plugin: got "'+e+'", expected an object or a function');Object.keys(e).forEach(function(t){Lt.prototype[t]=e[t]})}return this.__defaults&&(Lt.__defaults=J({},this.__defaults)),Lt},Lt.defaults=function(e){function t(e,n){if(!(this instanceof t))return new t(e,n);n=n||{},e&&"object"==typeof e&&(e=(n=e).name,delete n.name),n=J({},t.__defaults,n),Lt.call(this,e,n)}return(0,u.default)(t,Lt),t.preferredAdapters=Lt.preferredAdapters.slice(),Object.keys(Lt).forEach(function(e){e in t||(t[e]=Lt[e])}),t.__defaults=J({},this.__defaults,e),t},Lt.fetch=function(e,t){return Rt(e,t)};var Kt="7.1.1";function Jt(e,t){for(var n=e,r=0,i=t.length;r<i;r++){if(!(n=n[t[r]]))break}return n}function zt(e,t){return e<t?-1:e>t?1:0}function Ft(e){for(var t=[],n="",r=0,i=e.length;r<i;r++){var o=e[r];"."===o?r>0&&"\\"===e[r-1]?n=n.substring(0,n.length-1)+".":(t.push(n),n=""):n+=o}return t.push(n),t}var Ut=["$or","$nor","$not"];function Gt(e){return Ut.indexOf(e)>-1}function Qt(e){return Object.keys(e)[0]}function Vt(e){return e[Qt(e)]}function Wt(e){var t={};return e.forEach(function(e){Object.keys(e).forEach(function(n){var r=e[n];if("object"!=typeof r&&(r={$eq:r}),Gt(n))r instanceof Array?t[n]=r.map(function(e){return Wt([e])}):t[n]=Wt([r]);else{var i=t[n]=t[n]||{};Object.keys(r).forEach(function(e){var t=r[e];return"$gt"===e||"$gte"===e?Yt(e,t,i):"$lt"===e||"$lte"===e?Ht(e,t,i):"$ne"===e?Xt(t,i):"$eq"===e?Zt(t,i):void(i[e]=t)})}})}),t}function Yt(e,t,n){void 0===n.$eq&&(void 0!==n.$gte?"$gte"===e?t>n.$gte&&(n.$gte=t):t>=n.$gte&&(delete n.$gte,n.$gt=t):void 0!==n.$gt?"$gte"===e?t>n.$gt&&(delete n.$gt,n.$gte=t):t>n.$gt&&(n.$gt=t):n[e]=t)}function Ht(e,t,n){void 0===n.$eq&&(void 0!==n.$lte?"$lte"===e?t<n.$lte&&(n.$lte=t):t<=n.$lte&&(delete n.$lte,n.$lt=t):void 0!==n.$lt?"$lte"===e?t<n.$lt&&(delete n.$lt,n.$lte=t):t<n.$lt&&(n.$lt=t):n[e]=t)}function Xt(e,t){"$ne"in t?t.$ne.push(e):t.$ne=[e]}function Zt(e,t){delete t.$gt,delete t.$gte,delete t.$lt,delete t.$lte,delete t.$ne,t.$eq=e}function en(e){for(var t in e){if(Array.isArray(e))for(var n in e)e[n].$and&&(e[n]=Wt(e[n].$and));var r=e[t];"object"==typeof r&&en(r)}return e}function tn(e,t){for(var n in e){"$and"===n&&(t=!0);var r=e[n];"object"==typeof r&&(t=tn(r,t))}return t}function nn(e){var t=q(e),n=!1;tn(t,!1)&&("$and"in(t=en(t))&&(t=Wt(t.$and)),n=!0),["$or","$nor"].forEach(function(e){e in t&&t[e].forEach(function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var r=t[n],i=e[r];"object"==typeof i&&null!==i||(e[r]={$eq:i})}})}),"$not"in t&&(t.$not=Wt([t.$not]));for(var r=Object.keys(t),i=0;i<r.length;i++){var o=r[i],a=t[o];"object"!=typeof a||null===a?a={$eq:a}:"$ne"in a&&!n&&(a.$ne=[a.$ne]),t[o]=a}return t}function rn(e,t,n){for(var r="",i=n-e.length;r.length<i;)r+=t;return r}function on(e,t,n){return rn(e,t,n)+e}var an=-324,sn=3,cn="";function un(e,t){if(e===t)return 0;e=fn(e),t=fn(t);var n=mn(e),r=mn(t);if(n-r!=0)return n-r;switch(typeof e){case"number":return e-t;case"boolean":return e<t?-1:1;case"string":return gn(e,t)}return Array.isArray(e)?_n(e,t):yn(e,t)}function fn(e){switch(typeof e){case"undefined":return null;case"number":return e===1/0||e===-1/0||isNaN(e)?null:e;case"object":var t=e;if(Array.isArray(e)){var n=e.length;e=new Array(n);for(var r=0;r<n;r++)e[r]=fn(t[r])}else{if(e instanceof Date)return e.toJSON();if(null!==e)for(var i in e={},t)if(t.hasOwnProperty(i)){var o=t[i];void 0!==o&&(e[i]=fn(o))}}}return e}function ln(e){if(null!==e)switch(typeof e){case"boolean":return e?1:0;case"number":return bn(e);case"string":return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var t=Array.isArray(e),n=t?e:Object.keys(e),r=-1,i=n.length,o="";if(t)for(;++r<i;)o+=dn(n[r]);else for(;++r<i;){var a=n[r];o+=dn(a)+dn(e[a])}return o}return""}function dn(e){return mn(e=fn(e))+cn+ln(e)+"\0"}function hn(e,t){var n,r=t;if("1"===e[t])n=0,t++;else{var i="0"===e[t];t++;var o="",a=e.substring(t,t+sn),s=parseInt(a,10)+an;for(i&&(s=-s),t+=sn;;){var c=e[t];if("\0"===c)break;o+=c,t++}n=1===(o=o.split(".")).length?parseInt(o,10):parseFloat(o[0]+"."+o[1]),i&&(n-=10),0!==s&&(n=parseFloat(n+"e"+s))}return{num:n,length:t-r}}function pn(e,t){var n=e.pop();if(t.length){var r=t[t.length-1];n===r.element&&(t.pop(),r=t[t.length-1]);var i=r.element,o=r.index;if(Array.isArray(i))i.push(n);else if(o===e.length-2){i[e.pop()]=n}else e.push(n)}}function vn(e){for(var t=[],n=[],r=0;;){var i=e[r++];if("\0"!==i)switch(i){case"1":t.push(null);break;case"2":t.push("1"===e[r]),r++;break;case"3":var o=hn(e,r);t.push(o.num),r+=o.length;break;case"4":for(var a="";;){var s=e[r];if("\0"===s)break;a+=s,r++}a=a.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),t.push(a);break;case"5":var c={element:[],index:t.length};t.push(c.element),n.push(c);break;case"6":var u={element:{},index:t.length};t.push(u.element),n.push(u);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+i)}else{if(1===t.length)return t.pop();pn(t,n)}}}function _n(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=un(e[r],t[r]);if(0!==i)return i}return e.length===t.length?0:e.length>t.length?1:-1}function gn(e,t){return e===t?0:e>t?1:-1}function yn(e,t){for(var n=Object.keys(e),r=Object.keys(t),i=Math.min(n.length,r.length),o=0;o<i;o++){var a=un(n[o],r[o]);if(0!==a)return a;if(0!==(a=un(e[n[o]],t[r[o]])))return a}return n.length===r.length?0:n.length>r.length?1:-1}function mn(e){var t=["boolean","number","string","object"].indexOf(typeof e);return~t?null===e?1:Array.isArray(e)?5:t<3?t+2:t+3:Array.isArray(e)?5:void 0}function bn(e){if(0===e)return"1";var t=e.toExponential().split(/e\+?/),n=parseInt(t[1],10),r=e<0,i=r?"0":"2",o=on(((r?-n:n)-an).toString(),"0",sn);i+=cn+o;var a=Math.abs(parseFloat(t[0]));r&&(a=10-a);var s=a.toFixed(20);return s=s.replace(/\.?0+$/,""),i+=cn+s}function wn(e){function t(t){return e.map(function(e){var n=Ft(Qt(e));return Jt(t,n)})}return function(e,n){var r=un(t(e.doc),t(n.doc));return 0!==r?r:zt(e.doc._id,n.doc._id)}}function kn(e,t,n){if(e=e.filter(function(e){return qn(e.doc,t.selector,n)}),t.sort){var r=wn(t.sort);e=e.sort(r),"string"!=typeof t.sort[0]&&"desc"===Vt(t.sort[0])&&(e=e.reverse())}if("limit"in t||"skip"in t){var i=t.skip||0,o=("limit"in t?t.limit:e.length)+i;e=e.slice(i,o)}return e}function qn(e,t,n){return n.every(function(n){var r=t[n],i=Ft(n),o=Jt(e,i);return Gt(n)?On(n,r,e):jn(r,e,i,o)})}function jn(e,t,n,r){return!e||("object"==typeof e?Object.keys(e).every(function(i){var o=e[i];return Sn(i,t,o,n,r)}):e===r)}function On(e,t,n){return"$or"===e?t.some(function(e){return qn(n,e,Object.keys(e))}):"$not"===e?!qn(n,t,Object.keys(t)):!t.find(function(e){return qn(n,e,Object.keys(e))})}function Sn(e,t,n,r,i){if(!Ln[e])throw new Error('unknown operator "'+e+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return Ln[e](t,n,r,i)}function En(e){return null!=e}function An(e){return void 0!==e}function xn(e,t){var n=t[0],r=t[1];if(0===n)throw new Error("Bad divisor, cannot divide by zero");if(parseInt(n,10)!==n)throw new Error("Divisor is not an integer");if(parseInt(r,10)!==r)throw new Error("Modulus is not an integer");return parseInt(e,10)===e&&e%n===r}function Pn(e,t){return t.some(function(t){return e instanceof Array?e.indexOf(t)>-1:e===t})}function Cn(e,t){return t.every(function(t){return e.indexOf(t)>-1})}function $n(e,t){return e.length===t}function Dn(e,t){return new RegExp(t).test(e)}function In(e,t){switch(t){case"null":return null===e;case"boolean":return"boolean"==typeof e;case"number":return"number"==typeof e;case"string":return"string"==typeof e;case"array":return e instanceof Array;case"object":return"[object Object]"==={}.toString.call(e)}throw new Error(t+" not supported as a type.Please use one of object, string, array, number, boolean or null.")}var Ln={$elemMatch:function(e,t,n,r){return!!Array.isArray(r)&&(0!==r.length&&("object"==typeof r[0]?r.some(function(e){return qn(e,t,Object.keys(t))}):r.some(function(r){return jn(t,e,n,r)})))},$allMatch:function(e,t,n,r){return!!Array.isArray(r)&&(0!==r.length&&("object"==typeof r[0]?r.every(function(e){return qn(e,t,Object.keys(t))}):r.every(function(r){return jn(t,e,n,r)})))},$eq:function(e,t,n,r){return An(r)&&0===un(r,t)},$gte:function(e,t,n,r){return An(r)&&un(r,t)>=0},$gt:function(e,t,n,r){return An(r)&&un(r,t)>0},$lte:function(e,t,n,r){return An(r)&&un(r,t)<=0},$lt:function(e,t,n,r){return An(r)&&un(r,t)<0},$exists:function(e,t,n,r){return t?An(r):!An(r)},$mod:function(e,t,n,r){return En(r)&&xn(r,t)},$ne:function(e,t,n,r){return t.every(function(e){return 0!==un(r,e)})},$in:function(e,t,n,r){return En(r)&&Pn(r,t)},$nin:function(e,t,n,r){return En(r)&&!Pn(r,t)},$size:function(e,t,n,r){return En(r)&&$n(r,t)},$all:function(e,t,n,r){return Array.isArray(r)&&Cn(r,t)},$regex:function(e,t,n,r){return En(r)&&Dn(r,t)},$type:function(e,t,n,r){return In(r,t)}};function Bn(e,t){if("object"!=typeof t)throw new Error("Selector error: expected a JSON object");var n=kn([{doc:e}],{selector:t=nn(t)},Object.keys(t));return n&&1===n.length}function Rn(e){return xe('"use strict";\nreturn '+e+";",{})}function Tn(e){return xe(["return function(doc) {",'  "use strict";',"  var emitted = false;","  var emit = function (a, b) {","    emitted = true;","  };","  var view = "+e+";","  view(doc);","  if (emitted) {","    return true;","  }","};"].join("\n"),{})}function Nn(e,t){if(e.selector&&e.filter&&"_selector"!==e.filter){var n="string"==typeof e.filter?e.filter:"function";return t(new Error('selector invalid for filter "'+n+'"'))}t()}function Mn(e){e.view&&!e.filter&&(e.filter="_view"),e.selector&&!e.filter&&(e.filter="_selector"),e.filter&&"string"==typeof e.filter&&("_view"===e.filter?e.view=qe(e.view):e.filter=qe(e.filter))}function Kn(e,t){return t.filter&&"string"==typeof t.filter&&!t.doc_ids&&!be(e.db)}function Jn(e,t){var n=t.complete;if("_view"===t.filter){if(!t.view||"string"!=typeof t.view){var r=pe(re,"`view` filter parameter not found or invalid.");return n(r)}var i=ke(t.view);e.db.get("_design/"+i[0],function(r,o){if(e.isCancelled)return n(null,{status:"cancelled"});if(r)return n(ve(r));var a=o&&o.views&&o.views[i[1]]&&o.views[i[1]].map;if(!a)return n(pe(G,o.views?"missing json key: "+i[1]:"missing json key: views"));t.filter=Tn(a),e.doChanges(t)})}else if(t.selector)t.filter=function(e){return Bn(e,t.selector)},e.doChanges(t);else{var o=ke(t.filter);e.db.get("_design/"+o[0],function(r,i){if(e.isCancelled)return n(null,{status:"cancelled"});if(r)return n(ve(r));var a=i&&i.filters&&i.filters[o[1]];if(!a)return n(pe(G,i&&i.filters?"missing json key: "+o[1]:"missing json key: filters"));t.filter=Rn(a),e.doChanges(t)})}}function zn(e){e._changesFilterPlugin={validate:Nn,normalize:Mn,shouldFilter:Kn,filter:Jn}}function Fn(e){return e.reduce(function(e,t){return e[t]=!0,e},{})}Lt.plugin(zn),Lt.version=Kt;var Un=Fn(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),Gn=Fn(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);function Qn(e){if(!/^\d+-./.test(e))return pe(fe);var t=e.indexOf("-"),n=e.substring(0,t),r=e.substring(t+1);return{prefix:parseInt(n,10),id:r}}function Vn(e,t){for(var n=e.start-e.ids.length+1,r=e.ids,i=[r[0],t,[]],o=1,a=r.length;o<a;o++)i=[r[o],{status:"missing"},[i]];return[{pos:n,ids:i}]}function Wn(e,t,n){var r,i,o;n||(n={deterministic_revs:!0});var a={status:"available"};if(e._deleted&&(a.deleted=!0),t)if(e._id||(e._id=Xe()),i=He(e,n.deterministic_revs),e._rev){if((o=Qn(e._rev)).error)return o;e._rev_tree=[{pos:o.prefix,ids:[o.id,{status:"missing"},[[i,a,[]]]]}],r=o.prefix+1}else e._rev_tree=[{pos:1,ids:[i,a,[]]}],r=1;else if(e._revisions&&(e._rev_tree=Vn(e._revisions,a),r=e._revisions.start,i=e._revisions.ids[0]),!e._rev_tree){if((o=Qn(e._rev)).error)return o;r=o.prefix,i=o.id,e._rev_tree=[{pos:r,ids:[i,a,[]]}]}me(e._id),e._rev=r+"-"+i;var s={metadata:{},data:{}};for(var c in e)if(Object.prototype.hasOwnProperty.call(e,c)){var u="_"===c[0];if(u&&!Un[c]){var f=pe(ne,c);throw f.message=ne.message+": "+c,f}u&&!Gn[c]?s.metadata[c.slice(1)]=e[c]:s.data[c]=e[c]}return s}function Yn(e){try{return $e(e)}catch(mo){return{error:pe(Z,"Attachment is not a valid base64 string")}}}function Hn(e,t,n){var r=Yn(e.data);if(r.error)return n(r.error);e.length=r.length,e.data="blob"===t?Be(r,e.content_type):"base64"===t?De(r):r,We(r,function(t){e.digest="md5-"+t,n()})}function Xn(e,t,n){We(e.data,function(r){e.digest="md5-"+r,e.length=e.data.size||e.data.length||0,"binary"===t?Me(e.data,function(t){e.data=t,n()}):"base64"===t?Ke(e.data,function(t){e.data=t,n()}):n()})}function Zn(e,t,n){if(e.stub)return n();"string"==typeof e.data?Hn(e,t,n):Xn(e,t,n)}function er(e,t,n){if(!e.length)return n();var r,i=0;function o(){i++,e.length===i&&(r?n(r):n())}e.forEach(function(e){var n=e.data&&e.data._attachments?Object.keys(e.data._attachments):[],i=0;if(!n.length)return o();function a(e){r=e,++i===n.length&&o()}for(var s in e.data._attachments)e.data._attachments.hasOwnProperty(s)&&Zn(e.data._attachments[s],t,a)})}function tr(e,t,n,r,i,o,a,s){if(vt(t.rev_tree,n.metadata.rev)&&!s)return r[i]=n,o();var c=t.winningRev||Ze(t),u="deleted"in t?t.deleted:gt(t,c),f="deleted"in n.metadata?n.metadata.deleted:gt(n.metadata),l=/^1-/.test(n.metadata.rev);if(u&&!f&&s&&l){var d=n.data;d._rev=c,d._id=n.metadata.id,n=Wn(d,s)}var h=pt(t.rev_tree,n.metadata.rev_tree[0],e);if(s&&(u&&f&&"new_leaf"!==h.conflicts||!u&&"new_leaf"!==h.conflicts||u&&!f&&"new_branch"===h.conflicts)){var p=pe(Q);return r[i]=p,o()}var v=n.metadata.rev;n.metadata.rev_tree=h.tree,n.stemmedRevs=h.stemmedRevs||[],t.rev_map&&(n.metadata.rev_map=t.rev_map);var _=Ze(n.metadata),g=gt(n.metadata,_),y=u===g?0:u<g?-1:1;a(n,_,g,v===_?g:gt(n.metadata,v),!0,y,i,o)}function nr(e){return"missing"===e.metadata.rev_tree[0].ids[1].status}function rr(e,t,n,i,o,a,s,c,u){e=e||1e3;var f=c.new_edits,l=new r,d=0,h=t.length;function p(){++d===h&&u&&u()}t.forEach(function(e,t){if(e._id&&yt(e._id)){var r=e._deleted?"_removeLocal":"_putLocal";n[r](e,{ctx:o},function(e,n){a[t]=e||n,p()})}else{var i=e.metadata.id;l.has(i)?(h--,l.get(i).push([e,t])):l.set(i,[[e,t]])}}),l.forEach(function(t,n){var r=0;function o(){++r<t.length?u():p()}function u(){var u=t[r],l=u[0],d=u[1];if(i.has(n))tr(e,i.get(n),l,a,d,o,s,f);else{var h=pt([],l.metadata.rev_tree[0],e);l.metadata.rev_tree=h.tree,l.stemmedRevs=h.stemmedRevs||[],function(e,t,n){var r=Ze(e.metadata),i=gt(e.metadata,r);if("was_delete"in c&&i)return a[t]=pe(G,"deleted"),n();if(f&&nr(e)){var o=pe(Q);return a[t]=o,n()}s(e,r,i,i,!1,i?0:1,t,n)}(l,d,o)}}u()})}var ir=5,or="document-store",ar="by-sequence",sr="attach-store",cr="attach-seq-store",ur="meta-store",fr="local-store",lr="detect-blob-support";function dr(e){try{return JSON.parse(e)}catch(mo){return s.default.parse(e)}}function hr(e){try{return JSON.stringify(e)}catch(mo){return s.default.stringify(e)}}function pr(e){return function(t){var n="unknown_error";t.target&&t.target.error&&(n=t.target.error.name||t.target.error.message),e(pe(ae,n,t.type))}}function vr(e,t,n){return{data:hr(e),winningRev:t,deletedOrLocal:n?"1":"0",seq:e.seq,id:e.id}}function _r(e){if(!e)return null;var t=dr(e.data);return t.winningRev=e.winningRev,t.deleted="1"===e.deletedOrLocal,t.seq=e.seq,t}function gr(e){if(!e)return e;var t=e._doc_id_rev.lastIndexOf(":");return e._id=e._doc_id_rev.substring(0,t-1),e._rev=e._doc_id_rev.substring(t+1),delete e._doc_id_rev,e}function yr(e,t,n,r){n?r(e?"string"!=typeof e?e:Re(e,t):Ie([""],{type:t})):e?"string"!=typeof e?Ne(e,function(e){r(De(e))}):r(e):r("")}function mr(e,t,n,r){var i=Object.keys(e._attachments||{});if(!i.length)return r&&r();var o=0;function a(){++o===i.length&&r&&r()}i.forEach(function(r){t.attachments&&t.include_docs?function(e,t){var r=e._attachments[t],i=r.digest;n.objectStore(sr).get(i).onsuccess=function(e){r.body=e.target.result.body,a()}}(e,r):(e._attachments[r].stub=!0,a())})}function br(e,t){return Promise.all(e.map(function(e){if(e.doc&&e.doc._attachments){var n=Object.keys(e.doc._attachments);return Promise.all(n.map(function(n){var r=e.doc._attachments[n];if("body"in r){var i=r.body,o=r.content_type;return new Promise(function(a){yr(i,o,t,function(t){e.doc._attachments[n]=J(A(r,["digest","content_type"]),{data:t}),a()})})}}))}}))}function wr(e,t,n){var r=[],i=n.objectStore(ar),o=n.objectStore(sr),a=n.objectStore(cr),s=e.length;function c(){--s||function(){if(!r.length)return;r.forEach(function(e){var t=a.index("digestSeq").count(IDBKeyRange.bound(e+"::",e+"::",!1,!1));t.onsuccess=function(t){var n=t.target.result;n||o.delete(e)}})}()}e.forEach(function(e){var n=i.index("_doc_id_rev"),o=t+"::"+e;n.getKey(o).onsuccess=function(e){var t=e.target.result;if("number"!=typeof t)return c();i.delete(t),a.index("seq").openCursor(IDBKeyRange.only(t)).onsuccess=function(e){var t=e.target.result;if(t){var n=t.value.digestSeq.split("::")[0];r.push(n),a.delete(t.primaryKey),t.continue()}else c()}}})}function kr(e,t,n){try{return{txn:e.transaction(t,n)}}catch(r){return{error:r}}}var qr=new R;function jr(e,t,n,i,o,a){for(var s,c,u,f,l,d,h,p,v=t.docs,_=0,g=v.length;_<g;_++){var y=v[_];y._id&&yt(y._id)||(y=v[_]=Wn(y,n.new_edits,e)).error&&!h&&(h=y)}if(h)return a(h);var m=!1,b=0,w=new Array(v.length),k=new r,q=!1,j=i._meta.blobSupport?"blob":"base64";function O(){m=!0,S()}function S(){p&&m&&(p.docCount+=b,d.put(p))}function E(){q||(qr.notify(i._meta.name),a(null,w))}function A(e,t,n,r,i,o,a,s){e.metadata.winningRev=t,e.metadata.deleted=n;var c=e.data;if(c._id=e.metadata.id,c._rev=e.metadata.rev,r&&(c._deleted=!0),c._attachments&&Object.keys(c._attachments).length)return function(e,t,n,r,i,o){var a=e.data,s=0,c=Object.keys(a._attachments);function u(){s===c.length&&x(e,t,n,r,i,o)}function l(){s++,u()}c.forEach(function(n){var r=e.data._attachments[n];if(r.stub)s++,u();else{var i=r.data;delete r.data,r.revpos=parseInt(t,10);var o=r.digest;!function(e,t,n){f.count(e).onsuccess=function(r){var i=r.target.result;if(i)return n();var o={digest:e,body:t},a=f.put(o);a.onsuccess=n}}(o,i,l)}})}(e,t,n,i,a,s);b+=o,S(),x(e,t,n,i,a,s)}function x(e,t,n,r,o,a){var f=e.data,d=e.metadata;function h(o){var a=e.stemmedRevs||[];r&&i.auto_compaction&&(a=a.concat(it(e.metadata))),a&&a.length&&wr(a,e.metadata.id,s),d.seq=o.target.result;var u=vr(d,t,n);c.put(u).onsuccess=p}function p(){w[o]={ok:!0,id:d.id,rev:d.rev},k.set(e.metadata.id,e.metadata),function(e,t,n){var r=0,i=Object.keys(e.data._attachments||{});if(!i.length)return n();function o(){++r===i.length&&n()}function a(n){var r=e.data._attachments[n].digest,i=l.put({seq:t,digestSeq:r+"::"+t});i.onsuccess=o,i.onerror=function(e){e.preventDefault(),e.stopPropagation(),o()}}for(var s=0;s<i.length;s++)a(i[s])}(e,d.seq,a)}f._doc_id_rev=d.id+"::"+d.rev,delete f._id,delete f._rev;var v=u.put(f);v.onsuccess=h,v.onerror=function(e){e.preventDefault(),e.stopPropagation(),u.index("_doc_id_rev").getKey(f._doc_id_rev).onsuccess=function(e){u.put(f,e.target.result).onsuccess=h}}}er(v,j,function(t){if(t)return a(t);!function(){var t=kr(o,[or,ar,sr,fr,cr,ur],"readwrite");if(t.error)return a(t.error);(s=t.txn).onabort=pr(a),s.ontimeout=pr(a),s.oncomplete=E,c=s.objectStore(or),u=s.objectStore(ar),f=s.objectStore(sr),l=s.objectStore(cr),(d=s.objectStore(ur)).get(ur).onsuccess=function(e){p=e.target.result,S()},function(e){var t=[];if(v.forEach(function(e){e.data&&e.data._attachments&&Object.keys(e.data._attachments).forEach(function(n){var r=e.data._attachments[n];r.stub&&t.push(r.digest)})}),!t.length)return e();var n,r=0;t.forEach(function(i){!function(e,t){f.get(e).onsuccess=function(n){if(n.target.result)t();else{var r=pe(de,"unknown stub attachment with digest "+e);r.status=412,t(r)}}}(i,function(i){i&&!n&&(n=i),++r===t.length&&e(n)})})}(function(t){if(t)return q=!0,a(t);!function(){if(!v.length)return;var t=0;function r(){++t===v.length&&rr(e.revs_limit,v,i,k,s,w,A,n,O)}function o(e){var t=_r(e.target.result);t&&k.set(t.id,t),r()}for(var a=0,u=v.length;a<u;a++){var f=v[a];if(f._id&&yt(f._id))r();else{var l=c.get(f.metadata.id);l.onsuccess=o}}}()})}()})}function Or(e,t,n,r,i){var o,a,s;function c(e){a=e.target.result,o&&i(o,a,s)}function u(e){o=e.target.result,a&&i(o,a,s)}function f(e){var t=e.target.result;if(!t)return i();i([t.key],[t.value],t)}-1===r&&(r=1e3),"function"==typeof e.getAll&&"function"==typeof e.getAllKeys&&r>1&&!n?(s={continue:function(){if(!o.length)return i();var n,s=o[o.length-1];if(t&&t.upper)try{n=IDBKeyRange.bound(s,t.upper,!0,t.upperOpen)}catch(mo){if("DataError"===mo.name&&0===mo.code)return i()}else n=IDBKeyRange.lowerBound(s,!0);t=n,o=null,a=null,e.getAll(t,r).onsuccess=c,e.getAllKeys(t,r).onsuccess=u}},e.getAll(t,r).onsuccess=c,e.getAllKeys(t,r).onsuccess=u):n?e.openCursor(t,"prev").onsuccess=f:e.openCursor(t).onsuccess=f}function Sr(e,t,n){if("function"!=typeof e.getAll){var r=[];e.openCursor(t).onsuccess=function(e){var t=e.target.result;t?(r.push(t.value),t.continue()):n({target:{result:r}})}}else e.getAll(t).onsuccess=n}function Er(e,t,n){var r=new Array(e.length),i=0;e.forEach(function(o,a){t.get(o).onsuccess=function(t){t.target.result?r[a]=t.target.result:r[a]={key:o,error:"not_found"},++i===e.length&&n(e,r,{})}})}function Ar(e,t,n,r,i){try{if(e&&t)return i?IDBKeyRange.bound(t,e,!n,!1):IDBKeyRange.bound(e,t,!1,!n);if(e)return i?IDBKeyRange.upperBound(e):IDBKeyRange.lowerBound(e);if(t)return i?IDBKeyRange.lowerBound(t,!n):IDBKeyRange.upperBound(t,!n);if(r)return IDBKeyRange.only(r)}catch(mo){return{error:mo}}return null}function xr(e,t,n){var r,i,o="startkey"in e&&e.startkey,a="endkey"in e&&e.endkey,s="key"in e&&e.key,c="keys"in e&&e.keys,u=e.skip||0,f="number"==typeof e.limit?e.limit:-1,l=!1!==e.inclusive_end;if(!c&&(i=(r=Ar(o,a,l,s,e.descending))&&r.error)&&("DataError"!==i.name||0!==i.code))return n(pe(ae,i.name,i.message));var d=[or,ar,ur];e.attachments&&d.push(sr);var h=kr(t,d,"readonly");if(h.error)return n(h.error);var p=h.txn;p.oncomplete=function(){e.attachments?br(w,e.binary).then(O):O()},p.onabort=pr(n);var v,_,g=p.objectStore(or),y=p.objectStore(ar),m=p.objectStore(ur),b=y.index("_doc_id_rev"),w=[];function k(t,n){var r={id:n.id,key:n.id,value:{rev:t}};n.deleted?c&&(w.push(r),r.value.deleted=!0,r.doc=null):u--<=0&&(w.push(r),e.include_docs&&function(t,n,r){var i=t.id+"::"+r;b.get(i).onsuccess=function(r){if(n.doc=gr(r.target.result)||{},e.conflicts){var i=rt(t);i.length&&(n.doc._conflicts=i)}mr(n.doc,e,p)}}(n,r,t))}function q(e){for(var t=0,n=e.length;t<n&&w.length!==f;t++){var r=e[t];if(r.error&&c)w.push(r);else{var i=_r(r);k(i.winningRev,i)}}}function j(e,t,n){n&&(q(t),w.length<f&&n.continue())}function O(){var t={total_rows:v,offset:e.skip,rows:w};e.update_seq&&void 0!==_&&(t.update_seq=_),n(null,t)}return m.get(ur).onsuccess=function(e){v=e.target.result.docCount},e.update_seq&&function(e,t){e.openCursor(null,"prev").onsuccess=function(e){var n=e.target.result,r=void 0;n&&n.key&&(r=n.key);return t({target:{result:[r]}})}}(y,function(e){e.target.result&&e.target.result.length>0&&(_=e.target.result[0])}),i||0===f?void 0:c?Er(e.keys,g,j):-1===f?Sr(g,r,function(t){var n=t.target.result;e.descending&&(n=n.reverse()),q(n)}):void Or(g,r,e.descending,f+u,j)}function Pr(e){return new Promise(function(t){var n=Ie([""]),r=e.objectStore(lr).put(n,"key");r.onsuccess=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)},r.onerror=e.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)}}).catch(function(){return!1})}function Cr(e,t){e.objectStore(or).index("deletedOrLocal").count(IDBKeyRange.only("0")).onsuccess=function(e){t(e.target.result)}}var $r=!1,Dr=[];function Ir(e,t,n,r){try{e(t,n)}catch(t){r.emit("error",t)}}function Lr(){!$r&&Dr.length&&($r=!0,Dr.shift()())}function Br(e,t,n){Dr.push(function(){e(function(e,r){Ir(t,e,r,n),$r=!1,(0,i.default)(function(){Lr(n)})})}),Lr()}function Rr(e,t,i,o){if((e=q(e)).continuous){var a=i+":"+Xe();return qr.addListener(i,a,t,e),qr.notify(i),{cancel:function(){qr.removeListener(i,a)}}}var s=e.doc_ids&&new n(e.doc_ids);e.since=e.since||0;var c=e.since,u="limit"in e?e.limit:-1;0===u&&(u=1);var f,l,d,h,p=[],v=0,_=ge(e),g=new r;function y(e,t,n,r){if(n.seq!==t)return r();if(n.winningRev===e._rev)return r(n,e);var i=e._id+"::"+n.winningRev;h.get(i).onsuccess=function(e){r(n,gr(e.target.result))}}function m(){e.complete(null,{results:p,last_seq:c})}var b=[or,ar];e.attachments&&b.push(sr);var w=kr(o,b,"readonly");if(w.error)return e.complete(w.error);(f=w.txn).onabort=pr(e.complete),f.oncomplete=function(){!e.continuous&&e.attachments?br(p).then(m):m()},l=f.objectStore(ar),d=f.objectStore(or),h=l.index("_doc_id_rev"),Or(l,e.since&&!e.descending?IDBKeyRange.lowerBound(e.since,!0):null,e.descending,u,function(t,n,r){if(r&&t.length){var i=new Array(t.length),o=new Array(t.length),a=0;n.forEach(function(n,c){!function(e,t,n){if(s&&!s.has(e._id))return n();var r=g.get(e._id);if(r)return y(e,t,r,n);d.get(e._id).onsuccess=function(i){r=_r(i.target.result),g.set(e._id,r),y(e,t,r,n)}}(gr(n),t[c],function(n,s){o[c]=n,i[c]=s,++a===t.length&&function(){for(var t=[],n=0,a=i.length;n<a&&v!==u;n++){var s=i[n];if(s){var c=o[n];t.push(l(c,s))}}Promise.all(t).then(function(t){for(var n=0,r=t.length;n<r;n++)t[n]&&e.onChange(t[n])}).catch(e.complete),v!==u&&r.continue()}()})})}function l(t,n){var r=e.processChange(n,t,e);c=r.seq=t.seq;var i=_(r);return"object"==typeof i?Promise.reject(i):i?(v++,e.return_docs&&p.push(r),e.attachments&&e.include_docs?new Promise(function(t){mr(n,e,f,function(){br([r],e.binary).then(function(){t(r)})})}):Promise.resolve(r)):Promise.resolve()}})}var Tr,Nr=new r,Mr=new r;function Kr(e,t){var n=this;Br(function(t){Jr(n,e,t)},t,n.constructor)}function Jr(e,t,n){var r=t.name,o=null;function a(e,t){var n=e.objectStore(or);n.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),n.openCursor().onsuccess=function(e){var r=e.target.result;if(r){var i=r.value,o=gt(i);i.deletedOrLocal=o?"1":"0",n.put(i),r.continue()}else t()}}function s(e,t){var n=e.objectStore(fr),r=e.objectStore(or),i=e.objectStore(ar);r.openCursor().onsuccess=function(e){var o=e.target.result;if(o){var a=o.value,s=a.id,c=yt(s),u=Ze(a);if(c){var f=s+"::"+u,l=s+"::",d=s+"::~",h=i.index("_doc_id_rev"),p=IDBKeyRange.bound(l,d,!1,!1),v=h.openCursor(p);v.onsuccess=function(e){if(v=e.target.result){var t=v.value;t._doc_id_rev===f&&n.put(t),i.delete(v.primaryKey),v.continue()}else r.delete(o.primaryKey),o.continue()}}else o.continue()}else t&&t()}}function c(e,t){var n=e.objectStore(ar),r=e.objectStore(sr),i=e.objectStore(cr);r.count().onsuccess=function(e){if(!e.target.result)return t();n.openCursor().onsuccess=function(e){var n=e.target.result;if(!n)return t();for(var r=n.value,o=n.primaryKey,a=Object.keys(r._attachments||{}),s={},c=0;c<a.length;c++){s[r._attachments[a[c]].digest]=!0}var u=Object.keys(s);for(c=0;c<u.length;c++){var f=u[c];i.put({seq:o,digestSeq:f+"::"+o})}n.continue()}}}function u(e){var t=e.objectStore(ar),n=e.objectStore(or);n.openCursor().onsuccess=function(e){var r=e.target.result;if(r){var i,o,a,s,c,u=(i=r.value).data?_r(i):(i.deleted="1"===i.deletedOrLocal,i);if(u.winningRev=u.winningRev||Ze(u),u.seq)return f();o=u.id+"::",a=u.id+"::",s=t.index("_doc_id_rev").openCursor(IDBKeyRange.bound(o,a)),c=0,s.onsuccess=function(e){var t=e.target.result;if(!t)return u.seq=c,f();var n=t.primaryKey;n>c&&(c=n),t.continue()}}function f(){var e=vr(u,u.winningRev,u.deleted);n.put(e).onsuccess=function(){r.continue()}}}}e._meta=null,e._remote=!1,e.type=function(){return"idb"},e._id=O(function(t){t(null,e._meta.instanceId)}),e._bulkDocs=function(n,r,i){jr(t,n,r,e,o,i)},e._get=function(e,t,n){var r,i,a,s=t.ctx;if(!s){var c=kr(o,[or,ar,sr],"readonly");if(c.error)return n(c.error);s=c.txn}function u(){n(a,{doc:r,metadata:i,ctx:s})}s.objectStore(or).get(e).onsuccess=function(e){if(!(i=_r(e.target.result)))return a=pe(G,"missing"),u();var n;if(t.rev)n=t.latest?mt(t.rev,i):t.rev;else if(n=i.winningRev,gt(i))return a=pe(G,"deleted"),u();var o=s.objectStore(ar),c=i.id+"::"+n;o.index("_doc_id_rev").get(c).onsuccess=function(e){if((r=e.target.result)&&(r=gr(r)),!r)return a=pe(G,"missing"),u();u()}}},e._getAttachment=function(e,t,n,r,i){var a;if(r.ctx)a=r.ctx;else{var s=kr(o,[or,ar,sr],"readonly");if(s.error)return i(s.error);a=s.txn}var c=n.digest,u=n.content_type;a.objectStore(sr).get(c).onsuccess=function(e){yr(e.target.result.body,u,r.binary,function(e){i(null,e)})}},e._info=function(t){var n,r,i=kr(o,[ur,ar],"readonly");if(i.error)return t(i.error);var a=i.txn;a.objectStore(ur).get(ur).onsuccess=function(e){r=e.target.result.docCount},a.objectStore(ar).openCursor(null,"prev").onsuccess=function(e){var t=e.target.result;n=t?t.key:0},a.oncomplete=function(){t(null,{doc_count:r,update_seq:n,idb_attachment_format:e._meta.blobSupport?"binary":"base64"})}},e._allDocs=function(e,t){xr(e,o,t)},e._changes=function(t){return Rr(t,e,r,o)},e._close=function(e){o.close(),Nr.delete(r),e()},e._getRevisionTree=function(e,t){var n=kr(o,[or],"readonly");if(n.error)return t(n.error);n.txn.objectStore(or).get(e).onsuccess=function(e){var n=_r(e.target.result);n?t(null,n.rev_tree):t(pe(G))}},e._doCompaction=function(e,t,n){var r=kr(o,[or,ar,sr,cr],"readwrite");if(r.error)return n(r.error);var i=r.txn;i.objectStore(or).get(e).onsuccess=function(n){var r=_r(n.target.result);et(r.rev_tree,function(e,n,r,i,o){var a=n+"-"+r;-1!==t.indexOf(a)&&(o.status="missing")}),wr(t,e,i);var o=r.winningRev,a=r.deleted;i.objectStore(or).put(vr(r,o,a))},i.onabort=pr(n),i.oncomplete=function(){n()}},e._getLocal=function(e,t){var n=kr(o,[fr],"readonly");if(n.error)return t(n.error);var r=n.txn.objectStore(fr).get(e);r.onerror=pr(t),r.onsuccess=function(e){var n=e.target.result;n?(delete n._doc_id_rev,t(null,n)):t(pe(G))}},e._putLocal=function(e,t,n){"function"==typeof t&&(n=t,t={}),delete e._revisions;var r=e._rev,i=e._id;e._rev=r?"0-"+(parseInt(r.split("-")[1],10)+1):"0-1";var a,s=t.ctx;if(!s){var c=kr(o,[fr],"readwrite");if(c.error)return n(c.error);(s=c.txn).onerror=pr(n),s.oncomplete=function(){a&&n(null,a)}}var u,f=s.objectStore(fr);r?(u=f.get(i)).onsuccess=function(i){var o=i.target.result;o&&o._rev===r?f.put(e).onsuccess=function(){a={ok:!0,id:e._id,rev:e._rev},t.ctx&&n(null,a)}:n(pe(Q))}:((u=f.add(e)).onerror=function(e){n(pe(Q)),e.preventDefault(),e.stopPropagation()},u.onsuccess=function(){a={ok:!0,id:e._id,rev:e._rev},t.ctx&&n(null,a)})},e._removeLocal=function(e,t,n){"function"==typeof t&&(n=t,t={});var r,i=t.ctx;if(!i){var a=kr(o,[fr],"readwrite");if(a.error)return n(a.error);(i=a.txn).oncomplete=function(){r&&n(null,r)}}var s=e._id,c=i.objectStore(fr),u=c.get(s);u.onerror=pr(n),u.onsuccess=function(i){var o=i.target.result;o&&o._rev===e._rev?(c.delete(s),r={ok:!0,id:s,rev:"0-0"},t.ctx&&n(null,r)):n(pe(G))}},e._destroy=function(e,t){qr.removeAllListeners(r);var n=Mr.get(r);n&&n.result&&(n.result.close(),Nr.delete(r));var i=indexedDB.deleteDatabase(r);i.onsuccess=function(){Mr.delete(r),L()&&r in localStorage&&delete localStorage[r],t(null,{ok:!0})},i.onerror=pr(t)};var f=Nr.get(r);if(f)return o=f.idb,e._meta=f.global,(0,i.default)(function(){n(null,e)});var l=indexedDB.open(r,ir);Mr.set(r,l),l.onupgradeneeded=function(e){var t=e.target.result;if(e.oldVersion<1)return function(e){var t=e.createObjectStore(or,{keyPath:"id"});e.createObjectStore(ar,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),e.createObjectStore(sr,{keyPath:"digest"}),e.createObjectStore(ur,{keyPath:"id",autoIncrement:!1}),e.createObjectStore(lr),t.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),e.createObjectStore(fr,{keyPath:"_id"});var n=e.createObjectStore(cr,{autoIncrement:!0});n.createIndex("seq","seq"),n.createIndex("digestSeq","digestSeq",{unique:!0})}(t);var n=e.currentTarget.transaction;e.oldVersion<3&&function(e){e.createObjectStore(fr,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}(t),e.oldVersion<4&&function(e){var t=e.createObjectStore(cr,{autoIncrement:!0});t.createIndex("seq","seq"),t.createIndex("digestSeq","digestSeq",{unique:!0})}(t);var r=[a,s,c,u],i=e.oldVersion;!function e(){var t=r[i-1];i++,t&&t(n,e)}()},l.onsuccess=function(t){(o=t.target.result).onversionchange=function(){o.close(),Nr.delete(r)},o.onabort=function(e){T("error","Database has a global failure",e.target.error),o.close(),Nr.delete(r)};var i,a,s,c,u=o.transaction([ur,lr,or],"readwrite"),f=!1;function l(){void 0!==s&&f&&(e._meta={name:r,instanceId:c,blobSupport:s},Nr.set(r,{idb:o,global:e._meta}),n(null,e))}function d(){if(void 0!==a&&void 0!==i){var e=r+"_id";e in i?c=i[e]:i[e]=c=Xe(),i.docCount=a,u.objectStore(ur).put(i)}}u.objectStore(ur).get(ur).onsuccess=function(e){i=e.target.result||{id:ur},d()},Cr(u,function(e){a=e,d()}),Tr||(Tr=Pr(u)),Tr.then(function(e){s=e,l()}),u.oncomplete=function(){f=!0,l()},u.onabort=pr(n)},l.onerror=function(){var e="Failed to open indexedDB, are you in private browsing mode?";T("error",e),n(pe(ae,e))}}function zr(e){e.adapter("idb",Kr,!0)}function Fr(e,t){return new Promise(function(n,r){var i,o=0,a=0,s=0,c=e.length;function u(){++s===c?i?r(i):n():d()}function f(){o--,u()}function l(e){o--,i=i||e,u()}function d(){for(;o<t&&a<c;)o++,e[a++]().then(f,l)}d()})}Kr.valid=function(){try{return"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(mo){return!1}};var Ur=25,Gr=50,Qr=5e3,Vr=1e4,Wr={};function Yr(e){var t=e.doc||e.ok,n=t&&t._attachments;n&&Object.keys(n).forEach(function(e){var t=n[e];t.data=Re(t.data,t.content_type)})}function Hr(e){return/^_design/.test(e)?"_design/"+encodeURIComponent(e.slice(8)):/^_local/.test(e)?"_local/"+encodeURIComponent(e.slice(7)):encodeURIComponent(e)}function Xr(e){return e._attachments&&Object.keys(e._attachments)?Promise.all(Object.keys(e._attachments).map(function(t){var n=e._attachments[t];if(n.data&&"string"!=typeof n.data)return new Promise(function(e){Ke(n.data,e)}).then(function(e){n.data=e})})):Promise.resolve()}function Zr(e){if(!e.prefix)return!1;var t=Ae(e.prefix).protocol;return"http"===t||"https"===t}function ei(e,t){if(Zr(t)){var n=t.name.substr(t.prefix.length);e=t.prefix.replace(/\/?$/,"/")+encodeURIComponent(n)}var r=Ae(e);(r.user||r.password)&&(r.auth={username:r.user,password:r.password});var i=r.path.replace(/(^\/|\/$)/g,"").split("/");return r.db=i.pop(),-1===r.db.indexOf("%")&&(r.db=encodeURIComponent(r.db)),r.path=i.join("/"),r}function ti(e,t){return ni(e,e.db+"/"+t)}function ni(e,t){var n=e.path?"/":"";return e.protocol+"://"+e.host+(e.port?":"+e.port:"")+"/"+e.path+n+t}function ri(e){return"?"+Object.keys(e).map(function(t){return t+"="+encodeURIComponent(e[t])}).join("&")}function ii(e){var t="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",n=-1!==t.indexOf("msie"),r=-1!==t.indexOf("trident"),i=-1!==t.indexOf("edge"),o=!("method"in e)||"GET"===e.method;return(n||r||i)&&o}function oi(e,t){var n=this,r=ei(e.name,e),o=ti(r,"");e=q(e);var a,s=function(t,n){if((n=n||{}).headers=n.headers||new Tt,n.credentials="include",e.auth||r.auth){var i=e.auth||r.auth,o=i.username+":"+i.password,a=De(unescape(encodeURIComponent(o)));n.headers.set("Authorization","Basic "+a)}var s=e.headers||{};return Object.keys(s).forEach(function(e){n.headers.append(e,s[e])}),ii(n)&&(t+=(-1===t.indexOf("?")?"?":"&")+"_nonce="+Date.now()),(e.fetch||Rt)(t,n)};function u(e,t){return E(e,(0,c.default)(function(e){l().then(function(){return t.apply(this,e)}).catch(function(t){e.pop()(t)})})).bind(n)}function f(e,t,n){var r={};return(t=t||{}).headers=t.headers||new Tt,t.headers.get("Content-Type")||t.headers.set("Content-Type","application/json"),t.headers.get("Accept")||t.headers.set("Accept","application/json"),s(e,t).then(function(e){return r.ok=e.ok,r.status=e.status,e.json()}).then(function(e){if(r.data=e,!r.ok){r.data.status=r.status;var t=ve(r.data);if(n)return n(t);throw t}if(Array.isArray(r.data)&&(r.data=r.data.map(function(e){return e.error||e.missing?ve(e):e})),!n)return r;n(null,r.data)})}function l(){return e.skip_setup?Promise.resolve():a||((a=f(o).catch(function(e){return e&&e.status&&404===e.status?(K(404,"PouchDB is just detecting if the remote exists."),f(o,{method:"PUT"})):Promise.reject(e)}).catch(function(e){return!(!e||!e.status||412!==e.status)||Promise.reject(e)})).catch(function(){a=null}),a)}function d(e){return e.split("/").map(encodeURIComponent).join("/")}(0,i.default)(function(){t(null,n)}),n._remote=!0,n.type=function(){return"http"},n.id=u("id",function(e){s(ni(r,"")).then(function(e){return e.json()}).catch(function(){return{}}).then(function(t){var n=t&&t.uuid?t.uuid+r.db:ti(r,"");e(null,n)})}),n.compact=u("compact",function(e,t){"function"==typeof e&&(t=e,e={}),e=q(e),f(ti(r,"_compact"),{method:"POST"}).then(function(){!function r(){n.info(function(n,i){i&&!i.compact_running?t(null,{ok:!0}):setTimeout(r,e.interval||200)})}()})}),n.bulkGet=E("bulkGet",function(e,t){var n=this;function i(t){var n={};e.revs&&(n.revs=!0),e.attachments&&(n.attachments=!0),e.latest&&(n.latest=!0),f(ti(r,"_bulk_get"+ri(n)),{method:"POST",body:JSON.stringify({docs:e.docs})}).then(function(n){e.attachments&&e.binary&&n.data.results.forEach(function(e){e.docs.forEach(Yr)}),t(null,n.data)}).catch(t)}function o(){var r=Gr,i=Math.ceil(e.docs.length/r),o=0,a=new Array(i);function s(e){return function(n,r){a[e]=r.results,++o===i&&t(null,{results:ye(a)})}}for(var c=0;c<i;c++){var u=A(e,["revs","attachments","binary","latest"]);u.docs=e.docs.slice(c*r,Math.min(e.docs.length,(c+1)*r)),I(n,u,s(c))}}var a=ni(r,""),s=Wr[a];"boolean"!=typeof s?i(function(e,n){e?(Wr[a]=!1,K(e.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),o()):(Wr[a]=!0,t(null,n))}):s?i(t):o()}),n._info=function(e){l().then(function(){return s(ti(r,""))}).then(function(e){return e.json()}).then(function(t){t.host=ti(r,""),e(null,t)}).catch(e)},n.fetch=function(e,t){return l().then(function(){var n="/"===e.substring(0,1)?ni(r,e.substring(1)):ti(r,e);return s(n,t)})},n.get=u("get",function(e,t,n){"function"==typeof t&&(n=t,t={});var i={};function o(e){var n=e._attachments,i=n&&Object.keys(n);if(n&&i.length)return Fr(i.map(function(i){return function(){return function(i){var o=n[i],a=Hr(e._id)+"/"+d(i)+"?rev="+e._rev;return s(ti(r,a)).then(function(e){return e.blob()}).then(function(e){return t.binary?e:new Promise(function(t){Ke(e,t)})}).then(function(e){delete o.stub,delete o.length,o.data=e})}(i)}}),5)}(t=q(t)).revs&&(i.revs=!0),t.revs_info&&(i.revs_info=!0),t.latest&&(i.latest=!0),t.open_revs&&("all"!==t.open_revs&&(t.open_revs=JSON.stringify(t.open_revs)),i.open_revs=t.open_revs),t.rev&&(i.rev=t.rev),t.conflicts&&(i.conflicts=t.conflicts),t.update_seq&&(i.update_seq=t.update_seq),e=Hr(e),f(ti(r,e+ri(i))).then(function(e){return Promise.resolve().then(function(){if(t.attachments)return n=e.data,Array.isArray(n)?Promise.all(n.map(function(e){if(e.ok)return o(e.ok)})):o(n);var n}).then(function(){n(null,e.data)})}).catch(function(t){t.docId=e,n(t)})}),n.remove=u("remove",function(e,t,n,i){var o;"string"==typeof t?(o={_id:e,_rev:t},"function"==typeof n&&(i=n,n={})):(o=e,"function"==typeof t?(i=t,n={}):(i=n,n=t));var a=o._rev||n.rev;f(ti(r,Hr(o._id))+"?rev="+a,{method:"DELETE"},i).catch(i)}),n.getAttachment=u("getAttachment",function(e,t,n,i){"function"==typeof n&&(i=n,n={});var o=n.rev?"?rev="+n.rev:"",a=ti(r,Hr(e))+"/"+d(t)+o;s(a,{method:"GET"}).then(function(e){if(e.headers.get("content-type"),e.ok)return e.blob();throw e}).then(function(e){i(null,e)}).catch(function(e){i(e)})}),n.removeAttachment=u("removeAttachment",function(e,t,n,i){f(ti(r,Hr(e)+"/"+d(t))+"?rev="+n,{method:"DELETE"},i).catch(i)}),n.putAttachment=u("putAttachment",function(e,t,n,i,o,a){"function"==typeof o&&(a=o,o=i,i=n,n=null);var s=Hr(e)+"/"+d(t),c=ti(r,s);if(n&&(c+="?rev="+n),"string"==typeof i){var u;try{u=$e(i)}catch(l){return a(pe(Z,"Attachment is not a valid base64 string"))}i=u?Be(u,o):""}f(c,{headers:new Tt({"Content-Type":o}),method:"PUT",body:i},a).catch(a)}),n._bulkDocs=function(e,t,n){e.new_edits=t.new_edits,l().then(function(){return Promise.all(e.docs.map(Xr))}).then(function(){return f(ti(r,"_bulk_docs"),{method:"POST",body:JSON.stringify(e)},n)}).catch(n)},n._put=function(e,t,n){l().then(function(){return Xr(e)}).then(function(){return f(ti(r,Hr(e._id)),{method:"PUT",body:JSON.stringify(e)})}).then(function(e){n(null,e.data)}).catch(function(t){t.docId=e&&e._id,n(t)})},n.allDocs=u("allDocs",function(e,t){"function"==typeof e&&(t=e,e={});var n,i={},o="GET";(e=q(e)).conflicts&&(i.conflicts=!0),e.update_seq&&(i.update_seq=!0),e.descending&&(i.descending=!0),e.include_docs&&(i.include_docs=!0),e.attachments&&(i.attachments=!0),e.key&&(i.key=JSON.stringify(e.key)),e.start_key&&(e.startkey=e.start_key),e.startkey&&(i.startkey=JSON.stringify(e.startkey)),e.end_key&&(e.endkey=e.end_key),e.endkey&&(i.endkey=JSON.stringify(e.endkey)),void 0!==e.inclusive_end&&(i.inclusive_end=!!e.inclusive_end),void 0!==e.limit&&(i.limit=e.limit),void 0!==e.skip&&(i.skip=e.skip);var a=ri(i);void 0!==e.keys&&(o="POST",n={keys:e.keys}),f(ti(r,"_all_docs"+a),{method:o,body:JSON.stringify(n)}).then(function(n){e.include_docs&&e.attachments&&e.binary&&n.data.rows.forEach(Yr),t(null,n.data)}).catch(t)}),n._changes=function(e){var t="batch_size"in e?e.batch_size:Ur;!(e=q(e)).continuous||"heartbeat"in e||(e.heartbeat=Vr);var n="timeout"in e?e.timeout:3e4;"timeout"in e&&e.timeout&&n-e.timeout<Qr&&(n=e.timeout+Qr),"heartbeat"in e&&e.heartbeat&&n-e.heartbeat<Qr&&(n=e.heartbeat+Qr);var o={};"timeout"in e&&e.timeout&&(o.timeout=e.timeout);var a=void 0!==e.limit&&e.limit,s=a;if(e.style&&(o.style=e.style),(e.include_docs||e.filter&&"function"==typeof e.filter)&&(o.include_docs=!0),e.attachments&&(o.attachments=!0),e.continuous&&(o.feed="longpoll"),e.seq_interval&&(o.seq_interval=e.seq_interval),e.conflicts&&(o.conflicts=!0),e.descending&&(o.descending=!0),e.update_seq&&(o.update_seq=!0),"heartbeat"in e&&e.heartbeat&&(o.heartbeat=e.heartbeat),e.filter&&"string"==typeof e.filter&&(o.filter=e.filter),e.view&&"string"==typeof e.view&&(o.filter="_view",o.view=e.view),e.query_params&&"object"==typeof e.query_params)for(var c in e.query_params)e.query_params.hasOwnProperty(c)&&(o[c]=e.query_params[c]);var u,d="GET";e.doc_ids?(o.filter="_doc_ids",d="POST",u={doc_ids:e.doc_ids}):e.selector&&(o.filter="_selector",d="POST",u={selector:e.selector});var h,p=new Bt,v=function(n,i){if(!e.aborted){o.since=n,"object"==typeof o.since&&(o.since=JSON.stringify(o.since)),e.descending?a&&(o.limit=s):o.limit=!a||s>t?t:s;var c=ti(r,"_changes"+ri(o)),v={signal:p.signal,method:d,body:JSON.stringify(u)};h=n,e.aborted||l().then(function(){return f(c,v,i)}).catch(i)}},_={results:[]},g=function(n,r){if(!e.aborted){var o=0;if(r&&r.results){o=r.results.length,_.last_seq=r.last_seq;var c=null,u=null;"number"==typeof r.pending&&(c=r.pending),"string"!=typeof _.last_seq&&"number"!=typeof _.last_seq||(u=_.last_seq);e.query_params,r.results=r.results.filter(function(t){s--;var n=ge(e)(t);return n&&(e.include_docs&&e.attachments&&e.binary&&Yr(t),e.return_docs&&_.results.push(t),e.onChange(t,c,u)),n})}else if(n)return e.aborted=!0,void e.complete(n);r&&r.last_seq&&(h=r.last_seq);var f=a&&s<=0||r&&o<t||e.descending;(!e.continuous||a&&s<=0)&&f?e.complete(null,_):(0,i.default)(function(){v(h,g)})}};return v(e.since||0,g),{cancel:function(){e.aborted=!0,p.abort()}}},n.revsDiff=u("revsDiff",function(e,t,n){"function"==typeof t&&(n=t,t={}),f(ti(r,"_revs_diff"),{method:"POST",body:JSON.stringify(e)},n).catch(n)}),n._close=function(e){e()},n._destroy=function(e,t){f(ti(r,""),{method:"DELETE"}).then(function(e){t(null,e)}).catch(function(e){404===e.status?t(null,{ok:!0}):t(e)})}}function ai(e){e.adapter("http",oi,!1),e.adapter("https",oi,!1)}function si(e){this.status=400,this.name="query_parse_error",this.message=e,this.error=!0;try{Error.captureStackTrace(this,si)}catch(mo){}}function ci(e){this.status=404,this.name="not_found",this.message=e,this.error=!0;try{Error.captureStackTrace(this,ci)}catch(mo){}}function ui(e){this.status=500,this.name="invalid_value",this.message=e,this.error=!0;try{Error.captureStackTrace(this,ui)}catch(mo){}}function fi(e,t){return t&&e.then(function(e){(0,i.default)(function(){t(null,e)})},function(e){(0,i.default)(function(){t(e)})}),e}function li(e){return(0,c.default)(function(t){var n=t.pop(),r=e.apply(this,t);return"function"==typeof n&&fi(r,n),r})}function di(e,t){return e.then(function(e){return t().then(function(){return e})},function(e){return t().then(function(){throw e})})}function hi(e,t){return function(){var n=arguments,r=this;return e.add(function(){return t.apply(r,n)})}}function pi(e){var t=new n(e),r=new Array(t.size),i=-1;return t.forEach(function(e){r[++i]=e}),r}function vi(e){var t=new Array(e.size),n=-1;return e.forEach(function(e,r){t[++n]=r}),t}function _i(e){return new ui("builtin "+e+" function requires map values to be numbers or number arrays")}function gi(e){for(var t=0,n=0,r=e.length;n<r;n++){var i=e[n];if("number"!=typeof i){if(!Array.isArray(i))throw _i("_sum");t="number"==typeof t?[t]:t;for(var o=0,a=i.length;o<a;o++){var s=i[o];if("number"!=typeof s)throw _i("_sum");void 0===t[o]?t.push(s):t[o]+=s}}else"number"==typeof t?t+=i:t[0]+=i}return t}oi.valid=function(){return!0},(0,u.default)(si,Error),(0,u.default)(ci,Error),(0,u.default)(ui,Error);var yi=T.bind(null,"log"),mi=Array.isArray,bi=JSON.parse;function wi(e,t){return xe("return ("+e.replace(/;\s*$/,"")+");",{emit:t,sum:gi,log:yi,isArray:mi,toJSON:bi})}function ki(){this.promise=new Promise(function(e){e()})}function qi(e){if(!e)return"undefined";switch(typeof e){case"function":case"string":return e.toString();default:return JSON.stringify(e)}}function ji(e,t){return qi(e)+qi(t)+"undefined"}function Oi(e,t,n,r,i,o){var a,s=ji(n,r);if(!i&&(a=e._cachedViews=e._cachedViews||{})[s])return a[s];var c=e.info().then(function(c){var u=c.db_name+"-mrview-"+(i?"temp":Ye(s));return Pe(e,"_local/"+o,function(e){e.views=e.views||{};var n=t;-1===n.indexOf("/")&&(n=t+"/"+t);var r=e.views[n]=e.views[n]||{};if(!r[u])return r[u]=!0,e}).then(function(){return e.registerDependentDatabase(u).then(function(t){var i=t.db;i.auto_compaction=!0;var o={name:u,db:i,sourceDB:e,adapter:e.adapter,mapFun:n,reduceFun:r};return o.db.get("_local/lastSeq").catch(function(e){if(404!==e.status)throw e}).then(function(e){return o.seq=e?e.seq:0,a&&o.db.once("destroyed",function(){delete a[s]}),o})})})});return a&&(a[s]=c),c}ki.prototype.add=function(e){return this.promise=this.promise.catch(function(){}).then(function(){return e()}),this.promise},ki.prototype.finish=function(){return this.promise};var Si={},Ei=new ki,Ai=50;function xi(e){return-1===e.indexOf("/")?[e,e]:e.split("/")}function Pi(e){return 1===e.length&&/^1-/.test(e[0].rev)}function Ci(e,t){try{e.emit("error",t)}catch(n){T("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),T("error",t)}}function $i(e,t,o,a){function s(e,t,n){try{t(n)}catch(mo){Ci(e,mo)}}function c(e,t,n,r,i){try{return{output:t(n,r,i)}}catch(mo){return Ci(e,mo),{error:mo}}}function u(e,t){var n=un(e.key,t.key);return 0!==n?n:un(e.value,t.value)}function f(e,t,n){return n=n||0,"number"==typeof t?e.slice(n,t+n):n>0?e.slice(n):e}function l(e){var t=e.value;return t&&"object"==typeof t&&t._id||e.id}function d(e){return function(t){return e.include_docs&&e.attachments&&e.binary&&function(e){e.rows.forEach(function(e){var t=e.doc&&e.doc._attachments;t&&Object.keys(t).forEach(function(e){var n=t[e];t[e].data=Re(n.data,n.content_type)})})}(t),t}}function h(e,t,n,r){var i=t[e];void 0!==i&&(r&&(i=encodeURIComponent(JSON.stringify(i))),n.push(e+"="+i))}function p(e){if(void 0!==e){var t=Number(e);return isNaN(t)||t!==parseInt(e,10)?e:t}}function v(e,t){var n=e.descending?"endkey":"startkey",r=e.descending?"startkey":"endkey";if(void 0!==e[n]&&void 0!==e[r]&&un(e[n],e[r])>0)throw new si("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(t.reduce&&!1!==e.reduce){if(e.include_docs)throw new si("{include_docs:true} is invalid for reduce");if(e.keys&&e.keys.length>1&&!e.group&&!e.group_level)throw new si("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach(function(t){var n=function(e){if(e){if("number"!=typeof e)return new si('Invalid value for integer: "'+e+'"');if(e<0)return new si('Invalid value for positive integer: "'+e+'"')}}(e[t]);if(n)throw n})}function _(e){return function(t){if(404===t.status)return e;throw t}}function g(e,t,r){var i="_local/doc_"+e,o={_id:i,keys:[]},a=r.get(e),s=a[0];return(Pi(a[1])?Promise.resolve(o):t.db.get(i).catch(_(o))).then(function(e){return function(e){return e.keys.length?t.db.allDocs({keys:e.keys,include_docs:!0}):Promise.resolve({rows:[]})}(e).then(function(t){return function(e,t){for(var r=[],i=new n,o=0,a=t.rows.length;o<a;o++){var c=t.rows[o].doc;if(c&&(r.push(c),i.add(c._id),c._deleted=!s.has(c._id),!c._deleted)){var u=s.get(c._id);"value"in u&&(c.value=u.value)}}var f=vi(s);return f.forEach(function(e){if(!i.has(e)){var t={_id:e},n=s.get(e);"value"in n&&(t.value=n.value),r.push(t)}}),e.keys=pi(f.concat(e.keys)),r.push(e),r}(e,t)})})}function y(e){var t="string"==typeof e?e:e.name,n=Si[t];return n||(n=Si[t]=new ki),n}function m(e){return hi(y(e),function(){return function(e){var n,i;var o=t(e.mapFun,function(e,t){var r={id:i._id,key:fn(e)};null!=t&&(r.value=fn(t));n.push(r)}),a=e.seq||0;function c(t,n){return function(){return function(e,t,n){return e.db.get("_local/lastSeq").catch(_({_id:"_local/lastSeq",seq:0})).then(function(r){var i=vi(t);return Promise.all(i.map(function(n){return g(n,e,t)})).then(function(t){var i=ye(t);return r.seq=n,i.push(r),e.db.bulkDocs({docs:i})})})}(e,t,n)}}var f=new ki;function l(){return e.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:a,limit:Ai}).then(d)}function d(t){var d=t.results;if(d.length){var p=function(t){for(var c=new r,f=0,l=t.length;f<l;f++){var d=t[f];if("_"!==d.doc._id[0]){n=[],(i=d.doc)._deleted||s(e.sourceDB,o,i),n.sort(u);var p=h(n);c.set(d.doc._id,[p,d.changes])}a=d.seq}return c}(d);if(f.add(c(p,a)),!(d.length<Ai))return l()}}function h(e){for(var t,n=new r,i=0,o=e.length;i<o;i++){var a=e[i],s=[a.key,a.id];i>0&&0===un(a.key,t)&&s.push(i),n.set(dn(s),a),t=a.key}return n}return l().then(function(){return f.finish()}).then(function(){e.seq=a})}(e)})()}function b(e,t){return hi(y(e),function(){return function(e,t){var n,i=e.reduceFun&&!1!==t.reduce,a=t.skip||0;void 0===t.keys||t.keys.length||(t.limit=0,delete t.keys);function s(t){return t.include_docs=!0,e.db.allDocs(t).then(function(e){return n=e.total_rows,e.rows.map(function(e){if("value"in e.doc&&"object"==typeof e.doc.value&&null!==e.doc.value){var t=Object.keys(e.doc.value).sort(),n=["id","key","value"];if(!(t<n||t>n))return e.doc.value}var r=vn(e.doc._id);return{key:r[0],id:r[1],value:"value"in e.doc?e.doc.value:null}})})}function u(s){var u;if(u=i?function(e,t,n){0===n.group_level&&delete n.group_level;var r=n.group||n.group_level,i=o(e.reduceFun),a=[],s=isNaN(n.group_level)?Number.POSITIVE_INFINITY:n.group_level;t.forEach(function(e){var t=a[a.length-1],n=r?e.key:null;if(r&&Array.isArray(n)&&(n=n.slice(0,s)),t&&0===un(t.groupKey,n))return t.keys.push([e.key,e.id]),void t.values.push(e.value);a.push({keys:[[e.key,e.id]],values:[e.value],groupKey:n})}),t=[];for(var u=0,l=a.length;u<l;u++){var d=a[u],h=c(e.sourceDB,i,d.keys,d.values,!1);if(h.error&&h.error instanceof ui)throw h.error;t.push({value:h.error?null:h.output,key:d.groupKey})}return{rows:f(t,n.limit,n.skip)}}(e,s,t):{total_rows:n,offset:a,rows:s},t.update_seq&&(u.update_seq=e.seq),t.include_docs){var d=pi(s.map(l));return e.sourceDB.allDocs({keys:d,include_docs:!0,conflicts:t.conflicts,attachments:t.attachments,binary:t.binary}).then(function(e){var t=new r;return e.rows.forEach(function(e){t.set(e.id,e.doc)}),s.forEach(function(e){var n=l(e),r=t.get(n);r&&(e.doc=r)}),u})}return u}if(void 0!==t.keys){var d=t.keys,h=d.map(function(e){var n={startkey:dn([e]),endkey:dn([e,{}])};return t.update_seq&&(n.update_seq=!0),s(n)});return Promise.all(h).then(ye).then(u)}var p,v,_={descending:t.descending};if(t.update_seq&&(_.update_seq=!0),"start_key"in t&&(p=t.start_key),"startkey"in t&&(p=t.startkey),"end_key"in t&&(v=t.end_key),"endkey"in t&&(v=t.endkey),void 0!==p&&(_.startkey=t.descending?dn([p,{}]):dn([p])),void 0!==v){var g=!1!==t.inclusive_end;t.descending&&(g=!g),_.endkey=dn(g?[v,{}]:[v])}if(void 0!==t.key){var y=dn([t.key]),m=dn([t.key,{}]);_.descending?(_.endkey=y,_.startkey=m):(_.startkey=y,_.endkey=m)}return i||("number"==typeof t.limit&&(_.limit=t.limit),_.skip=a),s(_).then(u)}(e,t)})()}function w(t,n,r){if("function"==typeof t._query)return function(e,t,n){return new Promise(function(r,i){e._query(t,n,function(e,t){if(e)return i(e);r(t)})})}(t,n,r);if(be(t))return function(e,t,n){var r,i,o,a=[],s="GET";if(h("reduce",n,a),h("include_docs",n,a),h("attachments",n,a),h("limit",n,a),h("descending",n,a),h("group",n,a),h("group_level",n,a),h("skip",n,a),h("stale",n,a),h("conflicts",n,a),h("startkey",n,a,!0),h("start_key",n,a,!0),h("endkey",n,a,!0),h("end_key",n,a,!0),h("inclusive_end",n,a),h("key",n,a,!0),h("update_seq",n,a),a=""===(a=a.join("&"))?"":"?"+a,void 0!==n.keys){var c="keys="+encodeURIComponent(JSON.stringify(n.keys));c.length+a.length+1<=2e3?a+=("?"===a[0]?"&":"?")+c:(s="POST","string"==typeof t?r={keys:n.keys}:t.keys=n.keys)}if("string"==typeof t){var u=xi(t);return e.fetch("_design/"+u[0]+"/_view/"+u[1]+a,{headers:new Tt({"Content-Type":"application/json"}),method:s,body:JSON.stringify(r)}).then(function(e){return i=e.ok,o=e.status,e.json()}).then(function(e){if(!i)throw e.status=o,ve(e);return e.rows.forEach(function(e){if(e.value&&e.value.error&&"builtin_reduce_error"===e.value.error)throw new Error(e.reason)}),e}).then(d(n))}return r=r||{},Object.keys(t).forEach(function(e){Array.isArray(t[e])?r[e]=t[e]:r[e]=t[e].toString()}),e.fetch("_temp_view"+a,{headers:new Tt({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(r)}).then(function(e){return i=e.ok,o=e.status,e.json()}).then(function(e){if(!i)throw e.status=o,ve(e);return e}).then(d(n))}(t,n,r);if("string"!=typeof n)return v(r,n),Ei.add(function(){return Oi(t,"temp_view/temp_view",n.map,n.reduce,!0,e).then(function(e){return di(m(e).then(function(){return b(e,r)}),function(){return e.db.destroy()})})}),Ei.finish();var o=n,s=xi(o),c=s[0],u=s[1];return t.get("_design/"+c).then(function(n){var s=n.views&&n.views[u];if(!s)throw new ci("ddoc "+n._id+" has no view named "+u);return a(n,u),v(r,s),Oi(t,o,s.map,s.reduce,!1,e).then(function(e){return"ok"===r.stale||"update_after"===r.stale?("update_after"===r.stale&&(0,i.default)(function(){m(e)}),b(e,r)):m(e).then(function(){return b(e,r)})})})}return{query:function(e,t,n){var r=this;"function"==typeof t&&(n=t,t={}),t=t?function(e){return e.group_level=p(e.group_level),e.limit=p(e.limit),e.skip=p(e.skip),e}(t):{},"function"==typeof e&&(e={map:e});var i=Promise.resolve().then(function(){return w(r,e,t)});return fi(i,n),i},viewCleanup:li(function(){var t=this;return"function"==typeof t._viewCleanup?function(e){return new Promise(function(t,n){e._viewCleanup(function(e,r){if(e)return n(e);t(r)})})}(t):be(t)?function(e){return e.fetch("_view_cleanup",{headers:new Tt({"Content-Type":"application/json"}),method:"POST"}).then(function(e){return e.json()})}(t):function(t){return t.get("_local/"+e).then(function(e){var i=new r;Object.keys(e.views).forEach(function(e){var t=xi(e),r="_design/"+t[0],o=t[1],a=i.get(r);a||(a=new n,i.set(r,a)),a.add(o)});var o={keys:vi(i),include_docs:!0};return t.allDocs(o).then(function(n){var r={};n.rows.forEach(function(t){var n=t.key.substring(8);i.get(t.key).forEach(function(i){var o=n+"/"+i;e.views[o]||(o=i);var a=Object.keys(e.views[o]),s=t.doc&&t.doc.views&&t.doc.views[i];a.forEach(function(e){r[e]=r[e]||s})})});var o=Object.keys(r).filter(function(e){return!r[e]}).map(function(e){return hi(y(e),function(){return new t.constructor(e,t.__opts).destroy()})()});return Promise.all(o).then(function(){return{ok:!0}})})},_({ok:!0}))}(t)})}}var Di={_sum:function(e,t){return gi(t)},_count:function(e,t){return t.length},_stats:function(e,t){return{sum:gi(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:function(e){for(var t=0,n=0,r=e.length;n<r;n++){var i=e[n];t+=i*i}return t}(t)}}};function Ii(e){if(/^_sum/.test(e))return Di._sum;if(/^_count/.test(e))return Di._count;if(/^_stats/.test(e))return Di._stats;if(/^_/.test(e))throw new Error(e+" is not a supported reduce function.")}function Li(e,t){if("function"==typeof e&&2===e.length){var n=e;return function(e){return n(e,t)}}return wi(e.toString(),t)}function Bi(e){var t=e.toString(),n=Ii(t);return n||wi(t)}function Ri(e,t){var n=e.views&&e.views[t];if("string"!=typeof n.map)throw new ci("ddoc "+e._id+" has no string view named "+t+", instead found object of type: "+typeof n.map)}var Ti="mrviews",Ni=$i(Ti,Li,Bi,Ri);function Mi(e,t,n){return Ni.query.call(this,e,t,n)}function Ki(e){return Ni.viewCleanup.call(this,e)}var Ji={query:Mi,viewCleanup:Ki};function zi(e){return/^1-/.test(e)}function Fi(e,t,n){return!e._attachments||!e._attachments[n]||e._attachments[n].digest!==t._attachments[n].digest}function Ui(e,t){var n=Object.keys(t._attachments);return Promise.all(n.map(function(n){return e.getAttachment(t._id,n,{rev:t._rev})}))}function Gi(e,t,n){var r=be(t)&&!be(e),i=Object.keys(n._attachments);return r?e.get(n._id).then(function(r){return Promise.all(i.map(function(i){return Fi(r,n,i)?t.getAttachment(n._id,i):e.getAttachment(r._id,i)}))}).catch(function(e){if(404!==e.status)throw e;return Ui(t,n)}):Ui(t,n)}function Qi(e){var t=[];return Object.keys(e).forEach(function(n){e[n].missing.forEach(function(e){t.push({id:n,rev:e})})}),{docs:t,revs:!0,latest:!0}}function Vi(e,t,n,r){n=q(n);var i=[],o=!0;function a(t){return e.allDocs({keys:t,include_docs:!0,conflicts:!0}).then(function(e){if(r.cancelled)throw new Error("cancelled");e.rows.forEach(function(e){var t;e.deleted||!e.doc||!zi(e.value.rev)||(t=e.doc,t._attachments&&Object.keys(t._attachments).length>0)||function(e){return e._conflicts&&e._conflicts.length>0}(e.doc)||(e.doc._conflicts&&delete e.doc._conflicts,i.push(e.doc),delete n[e.id])})})}return Promise.resolve().then(function(){var e=Object.keys(n).filter(function(e){var t=n[e].missing;return 1===t.length&&zi(t[0])});if(e.length>0)return a(e)}).then(function(){var a=Qi(n);if(a.docs.length)return e.bulkGet(a).then(function(n){if(r.cancelled)throw new Error("cancelled");return Promise.all(n.results.map(function(n){return Promise.all(n.docs.map(function(n){var r=n.ok;return n.error&&(o=!1),r&&r._attachments?Gi(t,e,r).then(function(e){var t=Object.keys(r._attachments);return e.forEach(function(e,n){var i=r._attachments[t[n]];delete i.stub,delete i.length,i.data=e}),r}):r}))})).then(function(e){i=i.concat(ye(e).filter(Boolean))})})}).then(function(){return{ok:o,docs:i}})}var Wi=1,Yi="pouchdb",Hi=5,Xi=0;function Zi(e,t,n,r,i){return e.get(t).catch(function(n){if(404===n.status)return"http"!==e.adapter&&"https"!==e.adapter||K(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:r,_id:t,history:[],replicator:Yi,version:Wi};throw n}).then(function(o){if(!i.cancelled&&o.last_seq!==n)return o.history=(o.history||[]).filter(function(e){return e.session_id!==r}),o.history.unshift({last_seq:n,session_id:r}),o.history=o.history.slice(0,Hi),o.version=Wi,o.replicator=Yi,o.session_id=r,o.last_seq=n,e.put(o).catch(function(o){if(409===o.status)return Zi(e,t,n,r,i);throw o})})}function eo(e,t,n,r,i){this.src=e,this.target=t,this.id=n,this.returnValue=r,this.opts=i||{}}eo.prototype.writeCheckpoint=function(e,t){var n=this;return this.updateTarget(e,t).then(function(){return n.updateSource(e,t)})},eo.prototype.updateTarget=function(e,t){return this.opts.writeTargetCheckpoint?Zi(this.target,this.id,e,t,this.returnValue):Promise.resolve(!0)},eo.prototype.updateSource=function(e,t){if(this.opts.writeSourceCheckpoint){var n=this;return Zi(this.src,this.id,e,t,this.returnValue).catch(function(e){if(oo(e))return n.opts.writeSourceCheckpoint=!1,!0;throw e})}return Promise.resolve(!0)};var to={undefined:function(e,t){return 0===un(e.last_seq,t.last_seq)?t.last_seq:0},1:function(e,t){return no(t,e).last_seq}};function no(e,t){return e.session_id===t.session_id?{last_seq:e.last_seq,history:e.history}:ro(e.history,t.history)}function ro(e,t){var n=e[0],r=e.slice(1),i=t[0],o=t.slice(1);return n&&0!==t.length?io(n.session_id,t)?{last_seq:n.last_seq,history:e}:io(i.session_id,r)?{last_seq:i.last_seq,history:o}:ro(r,o):{last_seq:Xi,history:[]}}function io(e,t){var n=t[0],r=t.slice(1);return!(!e||0===t.length)&&(e===n.session_id||io(e,r))}function oo(e){return"number"==typeof e.status&&4===Math.floor(e.status/100)}eo.prototype.getCheckpoint=function(){var e=this;return e.opts&&e.opts.writeSourceCheckpoint&&!e.opts.writeTargetCheckpoint?e.src.get(e.id).then(function(e){return e.last_seq||Xi}).catch(function(e){if(404!==e.status)throw e;return Xi}):e.target.get(e.id).then(function(t){return e.opts&&e.opts.writeTargetCheckpoint&&!e.opts.writeSourceCheckpoint?t.last_seq||Xi:e.src.get(e.id).then(function(e){return t.version!==e.version?Xi:(n=t.version?t.version.toString():"undefined")in to?to[n](t,e):Xi;var n},function(n){if(404===n.status&&t.last_seq)return e.src.put({_id:e.id,last_seq:Xi}).then(function(){return Xi},function(n){return oo(n)?(e.opts.writeSourceCheckpoint=!1,t.last_seq):Xi});throw n})}).catch(function(e){if(404!==e.status)throw e;return Xi})};var ao=0;function so(e,t,n,r){if(!1===e.retry)return t.emit("error",n),void t.removeAllListeners();if("function"!=typeof e.back_off_function&&(e.back_off_function=M),t.emit("requestError",n),"active"===t.state||"pending"===t.state){t.emit("paused",n),t.state="stopped";var i=function(){e.current_back_off=ao};t.once("paused",function(){t.removeListener("active",i)}),t.once("active",i)}e.current_back_off=e.current_back_off||ao,e.current_back_off=e.back_off_function(e.current_back_off),setTimeout(r,e.current_back_off)}function co(e){return Object.keys(e).sort(un).reduce(function(t,n){return t[n]=e[n],t},{})}function uo(e,t,n){var r=n.doc_ids?n.doc_ids.sort(un):"",i=n.filter?n.filter.toString():"",o="",a="",s="";return n.selector&&(s=JSON.stringify(n.selector)),n.filter&&n.query_params&&(o=JSON.stringify(co(n.query_params))),n.filter&&"_view"===n.filter&&(a=n.view.toString()),Promise.all([e.id(),t.id()]).then(function(e){var t=e[0]+e[1]+i+a+o+r+s;return new Promise(function(e){We(t,e)})}).then(function(e){return"_local/"+(e=e.replace(/\//g,".").replace(/\+/g,"_"))})}function fo(e,t,n,r,o){var a,s,c,u=[],f={seq:0,changes:[],docs:[]},l=!1,d=!1,h=!1,p=0,v=n.continuous||n.live||!1,_=n.batch_size||100,g=n.batches_limit||10,y=!1,m=n.doc_ids,b=n.selector,w=[],k=Xe();o=o||{ok:!0,start_time:(new Date).toISOString(),docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var j={};function O(){return c?Promise.resolve():uo(e,t,n).then(function(i){s=i;var o={};o=!1===n.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!1}:"source"===n.checkpoint?{writeSourceCheckpoint:!0,writeTargetCheckpoint:!1}:"target"===n.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!0}:{writeSourceCheckpoint:!0,writeTargetCheckpoint:!0},c=new eo(e,t,s,r,o)})}function S(){if(w=[],0!==a.docs.length){var e=a.docs,i={timeout:n.timeout};return t.bulkDocs({docs:e,new_edits:!1},i).then(function(t){if(r.cancelled)throw $(),new Error("cancelled");var n=Object.create(null);t.forEach(function(e){e.error&&(n[e.id]=e)});var i=Object.keys(n).length;o.doc_write_failures+=i,o.docs_written+=e.length-i,e.forEach(function(e){var t=n[e._id];if(t){o.errors.push(t);var i=(t.name||"").toLowerCase();if("unauthorized"!==i&&"forbidden"!==i)throw t;r.emit("denied",q(t))}else w.push(e)})},function(t){throw o.doc_write_failures+=e.length,t})}}function E(){if(a.error)throw new Error("There was a problem getting docs.");o.last_seq=p=a.seq;var e=q(o);return w.length&&(e.docs=w,"number"==typeof a.pending&&(e.pending=a.pending,delete a.pending),r.emit("change",e)),l=!0,c.writeCheckpoint(a.seq,k).then(function(){if(l=!1,r.cancelled)throw $(),new Error("cancelled");a=void 0,B()}).catch(function(e){throw T(e),e})}function A(){return Vi(e,t,a.diffs,r).then(function(e){a.error=!e.ok,e.docs.forEach(function(e){delete a.diffs[e._id],o.docs_read++,a.docs.push(e)})})}function x(){var e;r.cancelled||a||(0!==u.length?(a=u.shift(),(e={},a.changes.forEach(function(t){"_user/"!==t.id&&(e[t.id]=t.changes.map(function(e){return e.rev}))}),t.revsDiff(e).then(function(e){if(r.cancelled)throw $(),new Error("cancelled");a.diffs=e})).then(A).then(S).then(E).then(x).catch(function(e){C("batch processing terminated with error",e)})):P(!0))}function P(e){0!==f.changes.length?(e||d||f.changes.length>=_)&&(u.push(f),f={seq:0,changes:[],docs:[]},"pending"!==r.state&&"stopped"!==r.state||(r.state="active",r.emit("active")),x()):0!==u.length||a||((v&&j.live||d)&&(r.state="pending",r.emit("paused")),d&&$())}function C(e,t){h||(t.message||(t.message=e),o.ok=!1,o.status="aborting",u=[],f={seq:0,changes:[],docs:[]},$(t))}function $(i){if(!(h||r.cancelled&&(o.status="cancelled",l)))if(o.status=o.status||"complete",o.end_time=(new Date).toISOString(),o.last_seq=p,h=!0,i){(i=pe(i)).result=o;var a=(i.name||"").toLowerCase();"unauthorized"===a||"forbidden"===a?(r.emit("error",i),r.removeAllListeners()):so(n,r,i,function(){fo(e,t,n,r)})}else r.emit("complete",o),r.removeAllListeners()}function D(e,t,o){if(r.cancelled)return $();"number"==typeof t&&(f.pending=t),ge(n)(e)&&(f.seq=e.seq||o,f.changes.push(e),(0,i.default)(function(){P(0===u.length&&j.live)}))}function I(e){if(y=!1,r.cancelled)return $();if(e.results.length>0)j.since=e.results[e.results.length-1].seq,B(),P(!0);else{var t=function(){v?(j.live=!0,B()):d=!0,P(!0)};a||0!==e.results.length?t():(l=!0,c.writeCheckpoint(e.last_seq,k).then(function(){l=!1,o.last_seq=p=e.last_seq,t()}).catch(T))}}function L(e){if(y=!1,r.cancelled)return $();C("changes rejected",e)}function B(){if(!y&&!d&&u.length<g){y=!0,r._changes&&(r.removeListener("cancel",r._abortChanges),r._changes.cancel()),r.once("cancel",i);var t=e.changes(j).on("change",D);t.then(o,o),t.then(I).catch(L),n.retry&&(r._changes=t,r._abortChanges=i)}function i(){t.cancel()}function o(){r.removeListener("cancel",i)}}function R(){O().then(function(){if(!r.cancelled)return c.getCheckpoint().then(function(e){j={since:p=e,limit:_,batch_size:_,style:"all_docs",doc_ids:m,selector:b,return_docs:!0},n.filter&&("string"!=typeof n.filter?j.include_docs=!0:j.filter=n.filter),"heartbeat"in n&&(j.heartbeat=n.heartbeat),"timeout"in n&&(j.timeout=n.timeout),n.query_params&&(j.query_params=n.query_params),n.view&&(j.view=n.view),B()});$()}).catch(function(e){C("getCheckpoint rejected with ",e)})}function T(e){l=!1,C("writeCheckpoint completed with error",e)}r.ready(e,t),r.cancelled?$():(r._addedListeners||(r.once("cancel",$),"function"==typeof n.complete&&(r.once("error",n.complete),r.once("complete",function(e){n.complete(null,e)})),r._addedListeners=!0),void 0===n.since?R():O().then(function(){return l=!0,c.writeCheckpoint(n.since,k)}).then(function(){l=!1,r.cancelled?$():(p=n.since,R())}).catch(T))}function lo(){f.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var e=this,t=new Promise(function(t,n){e.once("complete",t),e.once("error",n)});e.then=function(e,n){return t.then(e,n)},e.catch=function(e){return t.catch(e)},e.catch(function(){})}function ho(e,t){var n=t.PouchConstructor;return"string"==typeof e?new n(e,t):e}function po(e,t,n,r){if("function"==typeof n&&(r=n,n={}),void 0===n&&(n={}),n.doc_ids&&!Array.isArray(n.doc_ids))throw pe(re,"`doc_ids` filter parameter is not a list.");n.complete=r,(n=q(n)).continuous=n.continuous||n.live,n.retry="retry"in n&&n.retry,n.PouchConstructor=n.PouchConstructor||this;var i=new lo(n);return fo(ho(e,n),ho(t,n),n,i),i}function vo(e,t,n,r){return"function"==typeof n&&(r=n,n={}),void 0===n&&(n={}),(n=q(n)).PouchConstructor=n.PouchConstructor||this,new _o(e=ho(e,n),t=ho(t,n),n,r)}function _o(e,t,n,r){var i=this;this.canceled=!1;var o=n.push?J({},n,n.push):n,a=n.pull?J({},n,n.pull):n;function s(e){i.emit("change",{direction:"pull",change:e})}function c(e){i.emit("change",{direction:"push",change:e})}function u(e){i.emit("denied",{direction:"push",doc:e})}function f(e){i.emit("denied",{direction:"pull",doc:e})}function l(){i.pushPaused=!0,i.pullPaused&&i.emit("paused")}function d(){i.pullPaused=!0,i.pushPaused&&i.emit("paused")}function h(){i.pushPaused=!1,i.pullPaused&&i.emit("active",{direction:"push"})}function p(){i.pullPaused=!1,i.pushPaused&&i.emit("active",{direction:"pull"})}this.push=po(e,t,o),this.pull=po(t,e,a),this.pushPaused=!0,this.pullPaused=!0;var v={};function _(e){return function(t,n){("change"===t&&(n===s||n===c)||"denied"===t&&(n===f||n===u)||"paused"===t&&(n===d||n===l)||"active"===t&&(n===p||n===h))&&(t in v||(v[t]={}),v[t][e]=!0,2===Object.keys(v[t]).length&&i.removeAllListeners(t))}}function g(e,t,n){-1==e.listeners(t).indexOf(n)&&e.on(t,n)}n.live&&(this.push.on("complete",i.pull.cancel.bind(i.pull)),this.pull.on("complete",i.push.cancel.bind(i.push))),this.on("newListener",function(e){"change"===e?(g(i.pull,"change",s),g(i.push,"change",c)):"denied"===e?(g(i.pull,"denied",f),g(i.push,"denied",u)):"active"===e?(g(i.pull,"active",p),g(i.push,"active",h)):"paused"===e&&(g(i.pull,"paused",d),g(i.push,"paused",l))}),this.on("removeListener",function(e){"change"===e?(i.pull.removeListener("change",s),i.push.removeListener("change",c)):"denied"===e?(i.pull.removeListener("denied",f),i.push.removeListener("denied",u)):"active"===e?(i.pull.removeListener("active",p),i.push.removeListener("active",h)):"paused"===e&&(i.pull.removeListener("paused",d),i.push.removeListener("paused",l))}),this.pull.on("removeListener",_("pull")),this.push.on("removeListener",_("push"));var y=Promise.all([this.push,this.pull]).then(function(e){var t={push:e[0],pull:e[1]};return i.emit("complete",t),r&&r(null,t),i.removeAllListeners(),t},function(e){if(i.cancel(),r?r(e):i.emit("error",e),i.removeAllListeners(),r)throw e});this.then=function(e,t){return y.then(e,t)},this.catch=function(e){return y.catch(e)}}function go(e){e.replicate=po,e.sync=vo,Object.defineProperty(e.prototype,"replicate",{get:function(){var e=this;return void 0===this.replicateMethods&&(this.replicateMethods={from:function(t,n,r){return e.constructor.replicate(t,e,n,r)},to:function(t,n,r){return e.constructor.replicate(e,t,n,r)}}),this.replicateMethods}}),e.prototype.sync=function(e,t,n){return this.constructor.sync(this,e,t,n)}}(0,u.default)(lo,f.EventEmitter),lo.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},lo.prototype.ready=function(e,t){var n=this;function r(){n.cancel()}n._readyCalled||(n._readyCalled=!0,e.once("destroyed",r),t.once("destroyed",r),n.once("complete",function(){e.removeListener("destroyed",r),t.removeListener("destroyed",r)}))},(0,u.default)(_o,f.EventEmitter),_o.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},Lt.plugin(zr).plugin(ai).plugin(Ji).plugin(go);var yo=Lt;exports.default=yo;
},{"immediate":"EK2n","uuid":"gV9a","spark-md5":"AoQO","vuvuzela":"9d90","argsarray":"uOR/","inherits":"lZno","events":"hAhw","process":"0nx4"}],"j9tD":[function(require,module,exports) {
"use strict";var t=require("immediate");function e(){}var r={},n=["REJECTED"],o=["FULFILLED"],i=["PENDING"];function u(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=i,this.queue=[],this.outcome=void 0,t!==e&&f(this,t)}function c(t,e,r){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function s(e,n,o){t(function(){var t;try{t=n(o)}catch(i){return r.reject(e,i)}t===e?r.reject(e,new TypeError("Cannot resolve promise with itself")):r.resolve(e,t)})}function l(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function f(t,e){var n=!1;function o(e){n||(n=!0,r.reject(t,e))}function i(e){n||(n=!0,r.resolve(t,e))}var u=a(function(){e(i,o)});"error"===u.status&&o(u.value)}function a(t,e){var r={};try{r.value=t(e),r.status="success"}catch(n){r.status="error",r.value=n}return r}function h(t){return t instanceof this?t:r.resolve(new this(e),t)}function v(t){var n=new this(e);return r.reject(n,t)}function p(t){var n=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var o=t.length,i=!1;if(!o)return this.resolve([]);for(var u=new Array(o),c=0,s=-1,l=new this(e);++s<o;)f(t[s],s);return l;function f(t,e){n.resolve(t).then(function(t){u[e]=t,++c!==o||i||(i=!0,r.resolve(l,u))},function(t){i||(i=!0,r.reject(l,t))})}}function y(t){var n=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var o=t.length,i=!1;if(!o)return this.resolve([]);for(var u,c=-1,s=new this(e);++c<o;)u=t[c],n.resolve(u).then(function(t){i||(i=!0,r.resolve(s,t))},function(t){i||(i=!0,r.reject(s,t))});return s}module.exports=u,u.prototype.catch=function(t){return this.then(null,t)},u.prototype.then=function(t,r){if("function"!=typeof t&&this.state===o||"function"!=typeof r&&this.state===n)return this;var u=new this.constructor(e);this.state!==i?s(u,this.state===o?t:r,this.outcome):this.queue.push(new c(u,t,r));return u},c.prototype.callFulfilled=function(t){r.resolve(this.promise,t)},c.prototype.otherCallFulfilled=function(t){s(this.promise,this.onFulfilled,t)},c.prototype.callRejected=function(t){r.reject(this.promise,t)},c.prototype.otherCallRejected=function(t){s(this.promise,this.onRejected,t)},r.resolve=function(t,e){var n=a(l,e);if("error"===n.status)return r.reject(t,n.value);var i=n.value;if(i)f(t,i);else{t.state=o,t.outcome=e;for(var u=-1,c=t.queue.length;++u<c;)t.queue[u].callFulfilled(e)}return t},r.reject=function(t,e){t.state=n,t.outcome=e;for(var r=-1,o=t.queue.length;++r<o;)t.queue[r].callRejected(e);return t},u.resolve=h,u.reject=v,u.all=p,u.race=y;
},{"immediate":"EK2n"}],"irjG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("lie"));function t(e){return e&&e.__esModule?e:{default:e}}var r="function"==typeof Promise?Promise:e.default,o=r;exports.default=o;
},{"lie":"j9tD"}],"Yv2s":[function(require,module,exports) {
"use strict";var t=require("pouchdb-promise");function n(n,e,i){return"string"!=typeof e?t.reject(new Error("doc id is required")):n.get(e).catch(function(t){if(404!==t.status)throw t;return{}}).then(function(t){var u=t._rev,o=i(t);return o?(o._id=e,o._rev=u,r(n,o,i)):{updated:!1,rev:u,id:e}})}function r(t,r,e){return t.put(r).then(function(t){return{updated:!0,rev:t.rev,id:r._id}},function(i){if(409!==i.status)throw i;return n(t,r._id,e)})}exports.upsert=function(t,r,e){var i=n(this,t,r);if("function"!=typeof e)return i;i.then(function(t){e(null,t)},e)},exports.putIfNotExists=function(t,r,e){"string"!=typeof t&&(e=r,t=(r=t)._id);var i=n(this,t,function(t){return!t._rev&&r});if("function"!=typeof e)return i;i.then(function(t){e(null,t)},e)},"undefined"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(exports);
},{"pouchdb-promise":"irjG"}],"5CEW":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("pouchdb"));t.default.plugin(require("pouchdb-upsert"));var a={live:!0,retry:!0,continuous:!0,auth:{username:"wathentedightoessinglowe",password:"a44aade3e16923dc1f59ca0207b70b4570dca0c0"}},n=function(){return function(e){var n=this;this.pouch=new t.default("https://2aeca32c-420b-42c5-96ef-8032e3b74711-bluemix.cloudant.com/karaoke",a),this.couchData={leftUser:{name:"?",ratingAudience:0,ratingWatson:0,streamUrl:""},rightUser:{name:"?",ratingAudience:0,ratingWatson:0,streamUrl:""},songName:"?",karaokeUrl:"?",startTime:Date.now()+1500},this.onPouchUpdate=function(e){},this.onPouchUpdate=e,this.pouch.get("game").then(function(e){n.couchData=e,n.onPouchUpdate(e)}),this.pouch.changes({live:!0,since:"now"}).on("change",function(e){console.log("changed",e),n.pouch.get("game").then(function(e){n.couchData=e,n.onPouchUpdate(e)})})}}();exports.AppStore=n;
},{"pouchdb":"8iXQ","pouchdb-upsert":"Yv2s"}],"aQHk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./MasterStore"),t=document.querySelector("#leftStreamerVideo"),n=document.querySelector("#rightStreamerVideo"),r=document.querySelector(".switch-contestant1"),o=document.querySelector(".switch-contestant2"),c=document.querySelector(".contestant1"),i=document.querySelector(".contestant2"),s=document.querySelector("#voteLeft"),l=document.querySelector("#voteRight"),u=!0;function a(e,t){document.querySelectorAll(e).forEach(function(e){e.textContent=t})}var d=void 0;function m(e){return null==d?(d=e,!0):e.startTime==d.startTime}var f=new e.AppStore(function(e){m(e)&&(t.src=e.leftUser.streamUrl,n.src=e.rightUser.streamUrl,v()),a(".unameLeft",e.leftUser.name),a(".unameRight",e.rightUser.name)});function y(){console.log("disabled voting"),s.classList.add("disabled"),l.classList.add("disabled"),u=!1}function v(){console.log("enabled voting"),s.classList.remove("disabled"),l.classList.remove("disabled"),u=!0}s.onclick=function(){if(!u)return!1;f.pouch.upsert("game",function(e){var t=e;return t.leftUser.ratingAudience++,t}),y()},l.onclick=function(){if(!u)return!1;f.pouch.upsert("game",function(e){var t=e;return t.rightUser.ratingAudience--,t}),y()},r.addEventListener("click",function(){c.style.display="none",i.style.display="block"}),o.addEventListener("click",function(){i.style.display="none",c.style.display="block"});
},{"./MasterStore":"5CEW"}]},{},["aQHk"], null)
//# sourceMappingURL=/viewerIndex.2b5fdc7b.js.map